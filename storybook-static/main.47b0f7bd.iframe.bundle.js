(self.webpackChunkdbr_ui=self.webpackChunkdbr_ui||[]).push([[179],{"./generated-stories-entry.js":function(module,__unused_webpack_exports,__webpack_require__){"use strict";module=__webpack_require__.nmd(module),(0,__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js").configure)([__webpack_require__("./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$"),__webpack_require__("./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js|jsx|ts|tsx))$")],module,!1)},"./src/stories/Installation.stories.mdx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__page:function(){return __page}});__webpack_require__("./node_modules/react/index.js");var _mdx_js_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const Meta=(name="Meta",function MDXDefaultShortcode(props){return console.warn("Component "+name+" was not imported, exported, or provided by MDXProvider as global scope"),(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)("div",props)});var name;const layoutProps={};function MDXContent({components:components,...props}){return(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)(Meta,{title:"Home/Installation",mdxType:"Meta"}),(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)("h1",{id:"welcome-to-dbr-ui-library"},"Welcome to DBR ui library"),(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)("p",null,"DBR ui library helps you build UI components in isolation from your app's business logic, data, and context.\nThat makes it easy to develop. "))}MDXContent.isMDXComponent=!0;const __page=()=>{throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};const componentMeta={title:"Home/Installation",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs={...componentMeta.parameters.docs||{},page:()=>(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.aT,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)(MDXContent,null))},__webpack_exports__.default=componentMeta},"./src/stories/Dashboard.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Dashboard:function(){return Dashboard_stories_Dashboard},default:function(){return Dashboard_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),dayjs_min=__webpack_require__("./node_modules/dayjs/dayjs.min.js"),dayjs_min_default=__webpack_require__.n(dayjs_min),formatDate=function formatDate(date){return dayjs_min(new Date(date).toISOString()).format("DD-MM-YYYY")},axios=__webpack_require__("./src/api/axios.js"),resources=__webpack_require__("./src/constants/resources.js");var dashboard=__webpack_require__("./src/api/dashboard/index.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),inherits=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),createSuper=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createSuper.js"),core=__webpack_require__("./node_modules/@amcharts/amcharts4/core.js"),react_grid_layout=__webpack_require__("./node_modules/react-grid-layout/index.js"),react_sizeme=__webpack_require__("./node_modules/react-sizeme/dist/react-sizeme.js"),WidgetWrapper=(__webpack_require__("./node_modules/react-resizable/css/styles.css"),__webpack_require__("./src/components/Widget/WidgetWrapper.jsx")),NotificationService=__webpack_require__("./src/services/NotificationService.js"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),esm=__webpack_require__("./node_modules/socket.io-client/build/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),InputTypeText=(0,react.memo)((function(props){var tag=props.tag,_useState=(0,react.useState)({appParamsValue:{}}),_useState2=(0,slicedToArray.Z)(_useState,2),notification=_useState2[0],setNotification=_useState2[1],_useState3=(0,react.useState)(tag.configuration.inputText),_useState4=(0,slicedToArray.Z)(_useState3,2),text=_useState4[0],setText=_useState4[1];return(0,react.useEffect)((function(){NotificationService.O.getNotification().subscribe((function(widgetNotification){var _tag$configuration,_tag$configuration$ap;setNotification(widgetNotification),null!==(_tag$configuration=tag.configuration)&&void 0!==_tag$configuration&&null!==(_tag$configuration$ap=_tag$configuration.appParam)&&void 0!==_tag$configuration$ap&&_tag$configuration$ap.value&&setText(widgetNotification.appParamsValue[tag.configuration.appParam.value]||tag.configuration.inputText)}))}),[notification]),(0,jsx_runtime.jsx)("div",{children:text})})),Filter_InputTypeText=InputTypeText,reactstrap_modern=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),weekOfYear=(__webpack_require__("./node_modules/bootstrap-daterangepicker/daterangepicker.css"),__webpack_require__("./node_modules/dayjs/plugin/weekOfYear.js")),weekOfYear_default=__webpack_require__.n(weekOfYear);function isNotBetween(minDate,maxDate,selectedDay){return null!=minDate&&selectedDay.isBefore(minDate,"day")||null!=maxDate&&selectedDay.isAfter(maxDate,"day")}function isBetweenExclusive(startDate,endDate,day){return startDate&&endDate&&day>startDate&&day<endDate}function isoWeek(d){var day=new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate()));day.setUTCDate(day.getUTCDate()+4-(day.getUTCDay()||7));var yearStart=new Date(Date.UTC(day.getUTCFullYear(),0,1));return Math.ceil(((d-yearStart)/864e5+1)/7)}var classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames);dayjs_min_default().extend(weekOfYear_default());for(var unitType_DAY="DAY",unitType_WEEK="WEEK",calendar=dayjs_min_default()(),startOfWeek=calendar.startOf("week"),endOfWeek=calendar.endOf("week"),minDate=calendar.clone().subtract(5,"year"),maxDate=calendar.clone().add(5,"year"),minYear=calendar.clone().subtract(70,"year").format("YYYY"),maxYear=calendar.clone().add(70,"year").format("YYYY"),weekNames=[],s=startOfWeek;s<=endOfWeek;)weekNames.push(s.format("dd")),s=s.add(1,"day");for(var sY=parseInt(minYear),eY=parseInt(maxYear),yearNames=[];sY<eY;sY++)yearNames.push(sY);var state={locale:{weekNames:weekNames,weekLabel:"W",yearNames:yearNames},calendar:calendar,minDate:minDate,maxDate:maxDate,maxSpan:{years:5},minYear:minYear,maxYear:maxYear,showWeekNumbers:!0,showISOWeekNumbers:!1,buttonClasses:"btn btn-sm",applyButtonClasses:"btn-primary",cancelButtonClasses:"btn-default"};function PickerUI(props){var _props$dateRange=props.dateRange,start=_props$dateRange.start,end=_props$dateRange.end,_useState=(0,react.useState)(dayjs_min_default()(start)),_useState2=(0,slicedToArray.Z)(_useState,2),startDate=_useState2[0],setStartDate=_useState2[1],_useState3=(0,react.useState)(dayjs_min_default()(end)),_useState4=(0,slicedToArray.Z)(_useState3,2),endDate=_useState4[0],setEndDate=_useState4[1],_useState5=(0,react.useState)(""),_useState6=(0,slicedToArray.Z)(_useState5,2),range=_useState6[0],setRange=_useState6[1],_useState7=(0,react.useState)("CLOSED"),_useState8=(0,slicedToArray.Z)(_useState7,2),closedOrOpen=_useState8[0],setClosedOrOpen=_useState8[1],componentProps=(0,objectSpread2.Z)((0,objectSpread2.Z)({onDayClick:function onDayClick(day){var isOpen="OPEN"===closedOrOpen,endDateValue=isOpen&&day>=startDate?day:null,rangeValue=endDate||startDate,closedOrOpenValue=isOpen&&day>=startDate?"CLOSED":"OPEN";setStartDate(isOpen?startDate:day),setEndDate(endDateValue),setRange(rangeValue),setClosedOrOpen(closedOrOpenValue)},startDate:startDate,endDate:endDate,range:range,closedOrOpen:closedOrOpen},props),state),Component=props.component;return(0,jsx_runtime.jsxs)(Component,(0,objectSpread2.Z)((0,objectSpread2.Z)({},componentProps),{},{children:[(0,jsx_runtime.jsx)("div",{className:"ranges"}),(0,jsx_runtime.jsxs)("div",{className:"drp-buttons",style:{width:"100%"},children:[(0,jsx_runtime.jsx)("span",{className:"drp-selected",children:(0,jsx_runtime.jsx)("strong",{children:function dateLabel(){return startDate&&endDate?"".concat(startDate.format("DD/MM/YYYY")," - ").concat(endDate.format("DD/MM/YYYY")):""}()})}),(0,jsx_runtime.jsx)("button",{className:"cancelBtn btn btn-lg btn-light px-4 py-2",type:"button",onClick:function onCancelFunc(){(0,props.onCancel)()},children:"Cancel"}),(0,jsx_runtime.jsx)("button",{className:"applyBtn btn btn-lg btn-primary px-4 py-2",type:"button",onClick:function onApply(){var onDatesChange=props.onDatesChange;onDatesChange&&startDate&&endDate&&onDatesChange({startDate:startDate,endDate:endDate})},children:"Apply"})]})]}))}PickerUI.__docgenInfo={description:"",methods:[],displayName:"PickerUI",props:{dateRange:{type:{name:"object"},required:!1,description:""},onDatesChange:{type:{name:"func"},required:!1,description:""},onCancel:{type:{name:"func"},required:!1,description:""},component:{type:{name:"any"},required:!1,description:""}}};var Calendar_PickerUI=PickerUI;function Table(props){var className=props.className,style=props.style,children=props.children;return(0,jsx_runtime.jsx)("table",{style:style,className:className,children:children})}function TBody(props){var className=props.className,style=props.style,children=props.children;return(0,jsx_runtime.jsx)("tbody",{style:style,className:className,children:children})}function THead(props){var className=props.className,style=props.style,children=props.children;return(0,jsx_runtime.jsx)("thead",{style:style,className:className,children:children})}function Td(props){var className=props.className,style=props.style,children=props.children;return(0,jsx_runtime.jsx)("td",{style:style,className:className,children:children})}function Th(props){var className=props.className,onClick=props.onClick,style=props.style,children=props.children,colSpan=props.colSpan,onMouseDown=props.onMouseDown;return(0,jsx_runtime.jsx)("th",{style:style,onClick:onClick,colSpan:colSpan,onMouseDown:onMouseDown,className:className,children:children})}function Tr(props){var className=props.className,onClick=props.onClick,style=props.style,children=props.children;return(0,jsx_runtime.jsx)("tr",{style:style,onClick:onClick,className:className,children:children})}"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/PickerUI.jsx"]={name:"PickerUI",docgenInfo:PickerUI.__docgenInfo,path:"src/components/Common/Calendar/PickerUI.jsx"}),Table.__docgenInfo={description:"",methods:[],displayName:"Table",props:{className:{type:{name:"string"},required:!1,description:""},style:{type:{name:"string"},required:!1,description:""},children:{type:{name:"array"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/table/Table.jsx"]={name:"Table",docgenInfo:Table.__docgenInfo,path:"src/components/Common/Calendar/table/Table.jsx"}),TBody.__docgenInfo={description:"",methods:[],displayName:"TBody",props:{className:{type:{name:"string"},required:!1,description:""},style:{type:{name:"string"},required:!1,description:""},children:{type:{name:"any"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/table/TBody.jsx"]={name:"TBody",docgenInfo:TBody.__docgenInfo,path:"src/components/Common/Calendar/table/TBody.jsx"}),THead.__docgenInfo={description:"",methods:[],displayName:"THead",props:{className:{type:{name:"string"},required:!1,description:""},style:{type:{name:"string"},required:!1,description:""},children:{type:{name:"array"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/table/THead.jsx"]={name:"THead",docgenInfo:THead.__docgenInfo,path:"src/components/Common/Calendar/table/THead.jsx"}),Td.__docgenInfo={description:"",methods:[],displayName:"Td",props:{className:{type:{name:"string"},required:!1,description:""},style:{type:{name:"string"},required:!1,description:""},children:{type:{name:"array"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/table/Td.jsx"]={name:"Td",docgenInfo:Td.__docgenInfo,path:"src/components/Common/Calendar/table/Td.jsx"}),Th.__docgenInfo={description:"",methods:[],displayName:"Th",props:{className:{type:{name:"string"},required:!1,description:""},style:{type:{name:"string"},required:!1,description:""},children:{type:{name:"any"},required:!1,description:""},onClick:{type:{name:"func"},required:!1,description:""},onMouseDown:{type:{name:"func"},required:!1,description:""},colSpan:{type:{name:"number"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/table/Th.jsx"]={name:"Th",docgenInfo:Th.__docgenInfo,path:"src/components/Common/Calendar/table/Th.jsx"}),Tr.__docgenInfo={description:"",methods:[],displayName:"Tr",props:{className:{type:{name:"string"},required:!1,description:""},style:{type:{name:"string"},required:!1,description:""},children:{type:{name:"array"},required:!1,description:""},onClick:{type:{name:"func"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/table/Tr.jsx"]={name:"Tr",docgenInfo:Tr.__docgenInfo,path:"src/components/Common/Calendar/table/Tr.jsx"});var _cellMapper,defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js");function WeekCell(props){var week=props.week;return(0,jsx_runtime.jsx)("td",{className:"week",children:week})}function DayCell(props){var day=props.day,className=function cx(props){var day=props.day,calendar=props.calendar,startDate=props.startDate,endDate=props.endDate,range=props.range,maxDate=props.maxDate,minDate=props.minDate,weekend=function isWeekend(day){return day.day()>5||day.day()<1}(day),inRange=isBetweenExclusive(startDate,endDate,day)||isBetweenExclusive(startDate,range,day),isEndDate=endDate&&day.format("YYYY-MM-DD")===endDate.format("YYYY-MM-DD"),isStartDate=startDate&&day.format("YYYY-MM-DD")===startDate.format("YYYY-MM-DD"),active=isStartDate||isEndDate,off=calendar.month()!==day.month()||isNotBetween(minDate,maxDate,day),disabled=isNotBetween(minDate,maxDate,day),available=!disabled;return classnames_default()({weekend:weekend,"in-range":inRange,"end-date":isEndDate,"start-date":isStartDate,active:active,off:off,disabled:disabled,available:available})}((0,objectSpread2.Z)({},props));return(0,jsx_runtime.jsx)("td",{className:className,onClick:function handleOnClick(){var onDayClick=props.onDayClick,day=props.day;onDayClick&&onDayClick(day)},children:day.format("DD")})}WeekCell.__docgenInfo={description:"",methods:[],displayName:"WeekCell",props:{week:{type:{name:"any"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/cells/WeekCell.jsx"]={name:"WeekCell",docgenInfo:WeekCell.__docgenInfo,path:"src/components/Common/Calendar/cells/WeekCell.jsx"}),DayCell.__docgenInfo={description:"",methods:[],displayName:"DayCell",props:{day:{type:{name:"object"},required:!0,description:""},onDayClick:{type:{name:"func"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/cells/DayCell.jsx"]={name:"DayCell",docgenInfo:DayCell.__docgenInfo,path:"src/components/Common/Calendar/cells/DayCell.jsx"});var cellMapper=(_cellMapper={},(0,defineProperty.Z)(_cellMapper,unitType_DAY,DayCell),(0,defineProperty.Z)(_cellMapper,unitType_WEEK,WeekCell),_cellMapper);function CalendarBody(props){var RenderCells=(0,react.useCallback)((function(){for(var startDate=props.startDate,endDate=props.endDate,range=props.range,minDate=props.minDate,maxDate=props.maxDate,showWeekNumbers=props.showWeekNumbers,showISOWeekNumbers=props.showISOWeekNumbers,calendar=props.calendar,onDayClick=props.onDayClick,onDayMouseEnter=props.onDayMouseEnter,startOfWeek=calendar.startOf("month").startOf("week"),endOfWeek=calendar.endOf("month").endOf("week"),data=[],s=startOfWeek.clone();s<=endOfWeek;)data.push(s),s=s.add(1,"day");if(data.length<42)for(var fill=data.length;fill<42;fill++)data.push(s),s=s.add(1,"day");for(var resolvedData=[],cxi=0;cxi<6;cxi++){var rows=[],rxi=7*cxi,rxiDay=data[rxi];if(showISOWeekNumbers||showWeekNumbers){var week=showISOWeekNumbers?isoWeek(rxiDay.toDate()):rxiDay.week();rows.push({unitType:unitType_WEEK,key:0,week:week})}for(var initLength=rows.length,cxj=0;cxj<7;cxj++){var key=rxi+cxj,day=data[key],renderCellsProps={unitType:unitType_DAY,key:key+initLength,minDate:minDate,maxDate:maxDate,day:day,calendar:calendar,startDate:startDate,range:range,endDate:endDate,onDayMouseEnter:onDayMouseEnter,onDayClick:onDayClick};rows.push(renderCellsProps)}resolvedData.push(rows)}return resolvedData.map((function(rows,rowKey){var cell=rows.map((function(elts){var Component=cellMapper[elts.unitType];return(0,jsx_runtime.jsx)(Component,(0,objectSpread2.Z)({},elts))}));return(0,jsx_runtime.jsx)(Tr,{children:cell},rowKey)}))}));return(0,jsx_runtime.jsx)(TBody,{children:(0,jsx_runtime.jsx)(RenderCells,{})})}function CalendarNext(props){var next=props.next,calendar=props.calendar,className=classnames_default()({next:next,available:next}),onClick=calendar?function(){!function handleNextClick(calendar){var handleNext=props.handleNext;handleNext&&handleNext(calendar)}(calendar)}:function(){},Span=next?(0,jsx_runtime.jsx)("span",{}):null,nextProps={className:className,onClick:onClick};return(0,jsx_runtime.jsx)(Th,(0,objectSpread2.Z)((0,objectSpread2.Z)({},nextProps),{},{children:Span}))}function CalendarPrev(props){var calendar=props.calendar,prev=props.prev,className=classnames_default()({prev:prev,available:prev}),onClick=calendar?function(){!function handlePrevClick(calendar){var handlePrev=props.handlePrev;handlePrev&&handlePrev(calendar)}(calendar)}:function(){},Span=prev?(0,jsx_runtime.jsx)("span",{}):null,prevProps={className:className,onClick:onClick};return(0,jsx_runtime.jsx)(Th,(0,objectSpread2.Z)((0,objectSpread2.Z)({},prevProps),{},{children:Span}))}function CalendarTitle(props){var calendar=props.calendar,titleProps={colSpan:props.colSpan,className:props.className},label=calendar.format("MMM YYYY");return(0,jsx_runtime.jsx)(Th,(0,objectSpread2.Z)((0,objectSpread2.Z)({},titleProps),{},{children:label}))}function CalendarHeader(props){var nextDate=function nextDate(calendar){return calendar.add(1,"month")},prevDate=function prevDate(calendar){return calendar.subtract(1,"month")},showNext=props.showNext,calendar=props.calendar,handleNext=props.handleNext,showPrev=props.showPrev,handlePrev=props.handlePrev,createNextProps=(0,react.useCallback)((function(){return{next:showNext,calendar:nextDate(calendar),handleNext:handleNext}})),createPrevProps=(0,react.useCallback)((function(){return{prev:showPrev,calendar:prevDate(calendar),handlePrev:handlePrev}})),createTitleProps=(0,react.useCallback)((function(){var showISOWeekNumbers=props.showISOWeekNumbers,showWeekNumbers=props.showWeekNumbers;return{colSpan:showISOWeekNumbers||showWeekNumbers?6:5,calendar:calendar}})),renderWeeks=(0,react.useCallback)((function(){var showWeekNumbers=props.showWeekNumbers,showISOWeekNumbers=props.showISOWeekNumbers,_props$locale=props.locale,weekNames=_props$locale.weekNames,weekLabel=_props$locale.weekLabel,showWeeks=showISOWeekNumbers||showWeekNumbers,WeekData=(showWeeks?[weekLabel].concat(weekNames):weekNames).map((function(children,key){var thProps={children:children,className:classnames_default()({week:!(0!==key||!showWeeks)}),key:key};return(0,jsx_runtime.jsx)(Th,(0,objectSpread2.Z)({},thProps))}));return(0,jsx_runtime.jsx)(Tr,{children:WeekData})})),prev=createPrevProps(),next=createNextProps(),title=createTitleProps();return(0,jsx_runtime.jsxs)(THead,{children:[(0,jsx_runtime.jsxs)(Tr,{children:[(0,jsx_runtime.jsx)(CalendarPrev,(0,objectSpread2.Z)({},prev)),(0,jsx_runtime.jsx)(CalendarTitle,(0,objectSpread2.Z)({},title)),(0,jsx_runtime.jsx)(CalendarNext,(0,objectSpread2.Z)({},next))]}),renderWeeks()]})}function LinkedCalendar(props){var start=props.dateRange.start,_useState=(0,react.useState)(dayjs_min_default()(start)),_useState2=(0,slicedToArray.Z)(_useState,2),leftCalendar=_useState2[0],setLeftCalendar=_useState2[1],_useState3=(0,react.useState)(dayjs_min_default()(start).add(1,"month")),_useState4=(0,slicedToArray.Z)(_useState3,2),rightCalendar=_useState4[0],setRightCalendar=_useState4[1],handlePrev=function handlePrev(leftCal){setLeftCalendar(leftCal),setRightCalendar(leftCal.add(1,"month"))},handleNext=function handleNext(rightCal){setLeftCalendar(rightCal.subtract(1,"month")),setRightCalendar(rightCal)},leftState=(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{calendar:leftCalendar}),rightState=(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{calendar:rightCalendar}),leftProps=(0,objectSpread2.Z)({handlePrev:handlePrev,handleNext:function handleNext(){},handleSelected:handlePrev,showNext:!1,showPrev:!0},leftState),rightProps=(0,objectSpread2.Z)({showPrev:!1,showNext:!0,handlePrev:function handlePrev(){},handleNext:handleNext,handleSelected:handleNext},rightState),children=props.children,className=classnames_default()({"daterangepicker show-calendar row px-2 pt-2":!0});return(0,jsx_runtime.jsxs)("div",{className:className,style:{left:"auto",display:"flex"},children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("div",{className:"calendar-table pr-2",children:(0,jsx_runtime.jsxs)(Table,{className:"table-condensed",children:[(0,jsx_runtime.jsx)(CalendarHeader,(0,objectSpread2.Z)({},leftProps)),(0,jsx_runtime.jsx)(CalendarBody,(0,objectSpread2.Z)({},leftProps))]})})},0),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("div",{className:"calendar-table pl-2",children:(0,jsx_runtime.jsxs)(Table,{className:"table-condensed",children:[(0,jsx_runtime.jsx)(CalendarHeader,(0,objectSpread2.Z)({},rightProps)),(0,jsx_runtime.jsx)(CalendarBody,(0,objectSpread2.Z)({},rightProps))]})})},1),children]})}CalendarBody.__docgenInfo={description:"",methods:[],displayName:"CalendarBody",props:{startDate:{type:{name:"object"},required:!1,description:""},endDate:{type:{name:"object"},required:!1,description:""},minDate:{type:{name:"object"},required:!1,description:""},maxDate:{type:{name:"object"},required:!1,description:""},showISOWeekNumbers:{type:{name:"bool"},required:!0,description:""},showWeekNumbers:{type:{name:"bool"},required:!0,description:""},calendar:{type:{name:"object"},required:!0,description:""},range:{type:{name:"any"},required:!1,description:""},onDayClick:{type:{name:"func"},required:!1,description:""},onDayMouseEnter:{type:{name:"func"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/CalendarBody.jsx"]={name:"CalendarBody",docgenInfo:CalendarBody.__docgenInfo,path:"src/components/Common/Calendar/CalendarBody.jsx"}),CalendarNext.__docgenInfo={description:"",methods:[],displayName:"CalendarNext",props:{next:{type:{name:"bool"},required:!1,description:""},calendar:{type:{name:"object"},required:!0,description:""},handleNext:{type:{name:"func"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/CalendarNext.jsx"]={name:"CalendarNext",docgenInfo:CalendarNext.__docgenInfo,path:"src/components/Common/Calendar/CalendarNext.jsx"}),CalendarPrev.__docgenInfo={description:"",methods:[],displayName:"CalendarPrev",props:{prev:{type:{name:"bool"},required:!1,description:""},calendar:{type:{name:"object"},required:!0,description:""},handlePrev:{type:{name:"func"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/CalendarPrev.jsx"]={name:"CalendarPrev",docgenInfo:CalendarPrev.__docgenInfo,path:"src/components/Common/Calendar/CalendarPrev.jsx"}),CalendarTitle.__docgenInfo={description:"",methods:[],displayName:"CalendarTitle",props:{calendar:{type:{name:"object"},required:!0,description:""},colSpan:{type:{name:"number"},required:!0,description:""},className:{type:{name:"string"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/CalendarTitle.jsx"]={name:"CalendarTitle",docgenInfo:CalendarTitle.__docgenInfo,path:"src/components/Common/Calendar/CalendarTitle.jsx"}),CalendarHeader.__docgenInfo={description:"",methods:[],displayName:"CalendarHeader",props:{showISOWeekNumbers:{type:{name:"bool"},required:!1,description:""},showWeekNumbers:{type:{name:"bool"},required:!1,description:""},locale:{type:{name:"object"},required:!0,description:""},showNext:{type:{name:"bool"},required:!1,description:""},showPrev:{type:{name:"bool"},required:!1,description:""},handleNext:{type:{name:"func"},required:!0,description:""},handlePrev:{type:{name:"func"},required:!0,description:""},calendar:{type:{name:"any"},required:!1,description:""},showDropdowns:{type:{name:"bool"},required:!1,description:""},handleSelected:{type:{name:"func"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/CalendarHead.jsx"]={name:"CalendarHeader",docgenInfo:CalendarHeader.__docgenInfo,path:"src/components/Common/Calendar/CalendarHead.jsx"}),LinkedCalendar.__docgenInfo={description:"",methods:[],displayName:"LinkedCalendar",props:{children:{type:{name:"array"},required:!1,description:""},dateRange:{type:{name:"object"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/Calendar/LinkedCalendar.jsx"]={name:"LinkedCalendar",docgenInfo:LinkedCalendar.__docgenInfo,path:"src/components/Common/Calendar/LinkedCalendar.jsx"});var LinkedCalendarUI=react.memo((function LinkedCalendarUI(props){var uiProps=(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{component:LinkedCalendar});return(0,jsx_runtime.jsx)(Calendar_PickerUI,(0,objectSpread2.Z)({},uiProps))})),ranges=[{name:"Today",value:{start:dayjs_min().toDate(),end:dayjs_min().toDate()}},{name:"Yesterday",value:{start:dayjs_min().subtract(1,"days").toDate(),end:dayjs_min().subtract(1,"days").toDate()}},{name:"Last 7 Days",value:{start:dayjs_min().subtract(6,"days").toDate(),end:dayjs_min().toDate()}},{name:"Last 30 Days",value:{start:dayjs_min().subtract(29,"days").toDate(),end:dayjs_min().toDate()}},{name:"This Month",value:{start:dayjs_min().startOf("month").toDate(),end:dayjs_min().endOf("month").toDate()}},{name:"Last Month",value:{start:dayjs_min().subtract(1,"month").startOf("month").toDate(),end:dayjs_min().subtract(1,"month").endOf("month").toDate()}}],notification={appParamsValue:{}};function DatePicker(props){var tag=props.tag,onSendNotification=props.onSendNotification,_useState=(0,react.useState)(),_useState2=(0,slicedToArray.Z)(_useState,2),selectedDropdownItem=_useState2[0],setSelectedDropdownItem=_useState2[1],_useState3=(0,react.useState)({start:(new Date).setDate(0),end:new Date}),_useState4=(0,slicedToArray.Z)(_useState3,2),dateRange=_useState4[0],setDateRange=_useState4[1],_useState5=(0,react.useState)(!1),_useState6=(0,slicedToArray.Z)(_useState5,2),modalBasic=_useState6[0],setModalBasic=_useState6[1],start=dateRange.start,end=dateRange.end;(0,react.useEffect)((function(){var startDate=null!==tag.configuration.startDateRange?new Date(tag.configuration.startDateRange):dayjs_min().startOf("month").toDate(),endDate=null!==tag.configuration.endDateRange?new Date(tag.configuration.endDateRange):dayjs_min().endOf("month").toDate();setDateRange({start:startDate,end:endDate}),handleDateNotification(),NotificationService.O.getNotification().subscribe((function(widgetNotification){handleDateNotification(),notification=widgetNotification}))}),[]);var handleDateNotification=function handleDateNotification(){var _appParam$,_appParam$2,appParam=(null==tag?void 0:tag.configuration).appParam;if(2==(null==appParam?void 0:appParam.length)&&NotificationService.B.hasOwnProperty(null===(_appParam$=appParam[0])||void 0===_appParam$?void 0:_appParam$.value)&&NotificationService.B.hasOwnProperty(null===(_appParam$2=appParam[1])||void 0===_appParam$2?void 0:_appParam$2.value)){var startDate=Date.parse(NotificationService.B[appParam[0].value].split("-").reverse().join("/")),endDate=Date.parse(NotificationService.B[appParam[1].value].split("-").reverse().join("/"));dateRange.start=startDate,dateRange.end=endDate,setDateRange({start:startDate,end:endDate})}},dispatchDateFilterNotification=function dispatchDateFilterNotification(notification,startDate,endDate,filter){var _filter$configuration,_filter$configuration2;notification.appParamsValue[(null==filter||null===(_filter$configuration=filter.configuration)||void 0===_filter$configuration?void 0:_filter$configuration.appParam)&&filter.configuration.appParam[0]&&filter.configuration.appParam[0].value]=dayjs_min(startDate).format("DD-MM-YYYY"),notification.appParamsValue[(null==filter||null===(_filter$configuration2=filter.configuration)||void 0===_filter$configuration2?void 0:_filter$configuration2.appParam)&&filter.configuration.appParam[1]&&filter.configuration.appParam[1].value]=dayjs_min(endDate).format("DD-MM-YYYY"),NotificationService.O.sendNotification(notification),onSendNotification(notification)},onDatesChange=(0,react.useCallback)((function(_ref2){var startDate=_ref2.startDate,endDate=_ref2.endDate;setDateRange({start:new Date(startDate).toISOString(),end:new Date(endDate).toISOString()}),toggleModal(),dispatchDateFilterNotification(notification,startDate,endDate,tag)})),toggleModal=function toggleModal(){setModalBasic((function(mode){return!mode}))},startLabel=dayjs_min(start).format("MMM DD YYYY"),endLabel=dayjs_min(end).format("MMM DD YYYY");return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(reactstrap_modern.OB,{children:[(0,jsx_runtime.jsxs)(reactstrap_modern.Z_,{caret:!0,tag:"span",size:"xs",children:[(0,jsx_runtime.jsx)("i",{className:"simple-icon-calendar mr-2 "}),startLabel===endLabel?startLabel:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[startLabel,(0,jsx_runtime.jsx)("i",{className:"iconsminds-right ml-1 mr-1"}),endLabel]})]}),(0,jsx_runtime.jsxs)(reactstrap_modern.h_,{children:[ranges.map((function(elt){return(0,jsx_runtime.jsx)(reactstrap_modern.hP,{onClick:function onClick(){!function handleClick(_ref){var value=_ref.value,name=_ref.name,start=value.start,end=value.end;setSelectedDropdownItem(name),setDateRange({start:new Date(start).toISOString(),end:new Date(end).toISOString()}),dispatchDateFilterNotification(notification,start,end,tag)}(elt)},active:elt.name===selectedDropdownItem,children:elt.name},elt.name)})),(0,jsx_runtime.jsx)(reactstrap_modern.hP,{onClick:function onCustomRangeDropDownClick(){toggleModal(),setSelectedDropdownItem("custom-range")},active:"custom-range"===selectedDropdownItem,children:"Custom Range"},"custom-range"),(0,jsx_runtime.jsx)(reactstrap_modern.u_,{isOpen:modalBasic,children:(0,jsx_runtime.jsx)(LinkedCalendarUI,{dateRange:dateRange,onDatesChange:onDatesChange,onCancel:toggleModal})})]})]})})}DatePicker.__docgenInfo={description:"",methods:[],displayName:"DatePicker"};var DatePicker_DatePicker=DatePicker;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Common/DatePicker/DatePicker.jsx"]={name:"DatePicker",docgenInfo:DatePicker.__docgenInfo,path:"src/components/Common/DatePicker/DatePicker.jsx"});var Common_DatePicker=DatePicker_DatePicker,asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),noQueryDatasource=function noQueryDatasource(type){return"csv_file"===type},datasourceManager=__webpack_require__("./src/services/datasource/datasourceManager.js"),SelectOptionFilter=(0,react.forwardRef)((function(props,ref){var _tag$configuration2,_tag$configuration2$d,_tag$configuration2$d2,_jsx2,subscription,tag=props.tag,onSendNotification=props.onSendNotification,notification={appParamsValue:{}},_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),isOpenSizingLg=_useState2[0],setIsOpenSizingLg=_useState2[1],_useState3=(0,react.useState)("ALL"),_useState4=(0,slicedToArray.Z)(_useState3,2),selectedOption=_useState4[0],setSelectedOption=_useState4[1],_useState5=(0,react.useState)(tag.configuration.options||[]),_useState6=(0,slicedToArray.Z)(_useState5,2),options=_useState6[0],setOptions=_useState6[1],_useState7=(0,react.useState)(!1),_useState8=(0,slicedToArray.Z)(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];(0,react.useImperativeHandle)(ref,(function(){return{resetSelection:resetSelection}}));var fetchFilter=function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var paramsValue,datasource,result,dt,values,_args=arguments;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(paramsValue=_args.length>0&&void 0!==_args[0]?_args[0]:{},(datasource=(0,objectSpread2.Z)({},tag.configuration.dataSource)).query||noQueryDatasource(datasource.type)){_context.next=4;break}return _context.abrupt("return");case 4:return setLoading(!0),datasource.query&&(datasource.query.paramsValue=paramsValue),_context.next=8,(0,datasourceManager.f)(datasource);case 8:result=_context.sent,dt=result,values=Object.keys(dt).map((function(k){return dt[k]})).filter((function(option){return null!=option})),setOptions(values),tag.configuration.options=values,setLoading(!1);case 14:case"end":return _context.stop()}}),_callee)})));return function fetchFilter(){return _ref.apply(this,arguments)}}();(0,react.useEffect)((function(){return subscription=NotificationService.O.getNotification().subscribe((function(widgetNotification){var _tag$configuration,_tag$configuration$da,_tag$configuration$da2,_tag$configuration$da3;if(changeCurrentSelection(widgetNotification.appParamsValue),(null==tag||null===(_tag$configuration=tag.configuration)||void 0===_tag$configuration||null===(_tag$configuration$da=_tag$configuration.dataSource)||void 0===_tag$configuration$da||null===(_tag$configuration$da2=_tag$configuration$da.query)||void 0===_tag$configuration$da2||null===(_tag$configuration$da3=_tag$configuration$da2.urlParams)||void 0===_tag$configuration$da3?void 0:_tag$configuration$da3.length)>0){var urlParams=tag.configuration.dataSource.query.urlParams,oldValues=urlParams.map((function(key){return notification.appParamsValue[key]||""})),newValues=urlParams.map((function(key){return widgetNotification.appParamsValue[key]||""}));JSON.stringify(oldValues)!=JSON.stringify(newValues)&&fetchFilter(widgetNotification.appParamsValue)}else setLoading(!1),setOptions(tag.configuration.options);notification=(0,objectSpread2.Z)((0,objectSpread2.Z)({},widgetNotification),{},{appParamsValue:(0,objectSpread2.Z)({},widgetNotification.appParamsValue)})})),function(){subscription.unsubscribe()}}),[]),(0,react.useEffect)((function(){fetchFilter(notification),changeCurrentSelection(NotificationService.B)}),[null===(_tag$configuration2=tag.configuration)||void 0===_tag$configuration2||null===(_tag$configuration2$d=_tag$configuration2.dataSource)||void 0===_tag$configuration2$d||null===(_tag$configuration2$d2=_tag$configuration2$d.query)||void 0===_tag$configuration2$d2?void 0:_tag$configuration2$d2._id]);var changeCurrentSelection=function changeCurrentSelection(appParamsValue){var _tag$configuration$ap,_Object$keys;0!=(null===(_tag$configuration$ap=tag.configuration.appParam)||void 0===_tag$configuration$ap?void 0:_tag$configuration$ap.length)&&0!=(null===(_Object$keys=Object.keys(appParamsValue))||void 0===_Object$keys?void 0:_Object$keys.length)&&Object.keys(appParamsValue).forEach((function(key){var tagAppParam=tag.configuration.appParam.find((function(_ref2){var value=_ref2.value;return key==value}));if(tagAppParam){var selectedOption=tag.configuration.options.find((function(option){return option[tagAppParam.label]==appParamsValue[key]}));selectedOption&&setSelectedOption(selectedOption[tag.configuration.serviceParam]||Object.values(selectedOption)[0])}}))},dispatchFilterNotification=function dispatchFilterNotification(option){var _tag$configuration3;if(null!=tag&&null!==(_tag$configuration3=tag.configuration)&&void 0!==_tag$configuration3&&_tag$configuration3.appParam){var appParamsValue=[];(tag.configuration.appParam||[]).forEach((function(_ref3){var label=_ref3.label,value=_ref3.value;appParamsValue[value]=option[label]||""}));var newNotification={appParamsValue:appParamsValue,fromWidgetKey:""};NotificationService.O.sendNotification(newNotification),onSendNotification(newNotification)}},resetSelection=function resetSelection(){setSelectedOption("ALL")};return(0,jsx_runtime.jsxs)(reactstrap_modern.Kb,{isOpen:isOpenSizingLg,toggle:function toggle(){return setIsOpenSizingLg(!isOpenSizingLg)},children:[(0,jsx_runtime.jsx)(reactstrap_modern.Z_,(_jsx2={tag:"span",caret:!0,size:"xs",className:"w-100"},(0,defineProperty.Z)(_jsx2,"className","d-flex align-items-center"),(0,defineProperty.Z)(_jsx2,"children",(0,jsx_runtime.jsx)("span",{className:"truncate filter-value",title:selectedOption,children:selectedOption})),_jsx2)),(0,jsx_runtime.jsx)(reactstrap_modern.h_,{children:!1===loading?options&&options.length>0?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(reactstrap_modern.hP,{onClick:props.onReset,children:"ALL"}),(0,jsx_runtime.jsx)(reactstrap_modern.hP,{divider:!0,className:"mt-1 mb-1"}),options.map((function(option,index){return(0,jsx_runtime.jsx)(reactstrap_modern.hP,{onClick:function onClick(){return function selectOption(option){setSelectedOption(option[tag.configuration.serviceParam]||Object.values(option)[0]),dispatchFilterNotification(option)}(option)},children:option[tag.configuration.serviceParam]||Object.values(option)[0]},index)}))]}):(0,jsx_runtime.jsx)(reactstrap_modern.hP,{children:"No options found"}):(0,jsx_runtime.jsx)(reactstrap_modern.hP,{children:"Loading ..."})})]})}));SelectOptionFilter.__docgenInfo={description:"",methods:[],displayName:"SelectOptionFilter"};var Filter_SelectOptionFilter=SelectOptionFilter;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Filter/SelectOptionFilter.jsx"]={name:"SelectOptionFilter",docgenInfo:SelectOptionFilter.__docgenInfo,path:"src/components/Filter/SelectOptionFilter.jsx"});var Filters=(0,react.memo)((function(_ref){var socket,filters=_ref.filters,widgets=_ref.widgets,_ref5=(0,react.useRef)([]),_useState=(0,react.useState)(filters||[]),_useState2=(0,slicedToArray.Z)(_useState,2),tags=_useState2[0],setTags=_useState2[1],_useState3=(0,react.useState)(!1),_useState4=(0,slicedToArray.Z)(_useState3,2),setShowDeleteDialog=(_useState4[0],_useState4[1]),_useState5=(0,react.useState)({}),_useState6=(0,slicedToArray.Z)(_useState5,2),setSelecteFilter=(_useState6[0],_useState6[1]),_useState7=(0,react.useState)({appParamsValue:{}}),_useState8=(0,slicedToArray.Z)(_useState7,2),notification=_useState8[0],sendNotification=(_useState8[1],function sendNotification(notification){socket||(socket=createSocket());var notif=(0,objectSpread2.Z)((0,objectSpread2.Z)({},notification),{},{appParamsValue:(0,objectSpread2.Z)({},notification.appParamsValue)});socket.emit("SEND_NOTIFICATION",{widgetSocketId:socket.id,widgetNotification:notif}),setTimeout((function(){NotificationService.O.sendNotification(notification)}),100)});(0,react.useEffect)((function(){_ref5.current=_ref5.current.slice(0,tags.length),socket||(socket=createSocket())}),[tags]),(0,react.useEffect)((function(){var newFilters=(0,toConsumableArray.Z)(filters),widgetInputParams=Object.keys(widgets).map((function(key){var _widgets$key$widget;return null===(_widgets$key$widget=widgets[key].widget)||void 0===_widgets$key$widget?void 0:_widgets$key$widget.datasource})).reduce((function(acc,datasource){var _datasource$query,_datasource$query$url,_datasource$query2;(null==datasource||null===(_datasource$query=datasource.query)||void 0===_datasource$query||null===(_datasource$query$url=_datasource$query.urlParams)||void 0===_datasource$query$url?void 0:_datasource$query$url.length)>0&&(acc=[].concat((0,toConsumableArray.Z)(acc),(0,toConsumableArray.Z)(null==datasource||null===(_datasource$query2=datasource.query)||void 0===_datasource$query2?void 0:_datasource$query2.urlParams)));return acc}),[]),filtersAppParams=filters.reduce((function(acc,_ref2){var appParam=_ref2.configuration.appParam;return acc=[].concat((0,toConsumableArray.Z)(acc),(0,toConsumableArray.Z)(Array.isArray(appParam)?appParam.map((function(_ref3){return _ref3.value})):[appParam.value]))}),[]);(widgetInputParams=(0,toConsumableArray.Z)(new Set(widgetInputParams))).forEach((function(paramName,index){NotificationService.B[paramName]&&filtersAppParams.indexOf(paramName)<0&&newFilters.push({_id:"".concat(paramName,"_").concat(index),name:paramName,type:"inputText",configuration:{appParam:{label:paramName,value:paramName},inputText:NotificationService.B[paramName]}})})),setTags(newFilters)}),[filters,Object.keys(NotificationService.B).length]);var createSocket=function createSocket(){return(socket=(0,esm.ZP)(resources.gs,{path:"/back/socket",transports:["websocket","polling"]})).on("connect",(function(){NotificationService.O.registerWidgetSocket(socket)})),socket.on("RECEIVE_NOTIFICATION",(function(notification){notification.widgetSocketId!=socket.id&&(NotificationService.O.isWidgetRegistredInSocketPool(notification.widgetSocketId)||NotificationService.O.sendNotification(notification.widgetNotification))})),socket},resetAppParams=function resetAppParams(filter){var _filter$configuration;Array.isArray(filter.configuration.appParam)?filter.configuration.appParam.forEach((function(_ref4){var value=_ref4.value;notification.appParamsValue[value]=""})):notification.appParamsValue[null===(_filter$configuration=filter.configuration.appParam)||void 0===_filter$configuration?void 0:_filter$configuration.value]="";sendNotification(notification)};return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)("div",{className:"dashboard-filters flex-wrap",children:tags&&tags.map((function(tag,index){var _tag$configuration$ap;return(0,jsx_runtime.jsxs)("div",{className:"filter-item",children:[(0,jsx_runtime.jsxs)("div",{className:"filter-item__title d-flex justify-content-between",children:[(0,jsx_runtime.jsx)("span",{children:tag.name||(null===(_tag$configuration$ap=tag.configuration.appParam)||void 0===_tag$configuration$ap?void 0:_tag$configuration$ap.label)}),"inputText"==tag.type?(0,jsx_runtime.jsx)(reactstrap_modern.zx,{close:!0,onClick:function onClick(){return function removeFilterTag(indexToRemove,filterToRemove){setShowDeleteDialog(!0),setSelecteFilter({item:filterToRemove,index:indexToRemove})}(index,tag)}}):null]}),(0,jsx_runtime.jsx)("span",{className:"filter-item__value",children:"datePickerAvance"===tag.type?(0,jsx_runtime.jsx)(Common_DatePicker,{onSendNotification:sendNotification,tag:tag}):"inputText"===tag.type?(0,jsx_runtime.jsx)("span",{onClick:function onClick(){var _tag$configuration$ap2;return function dispatchFilterNotification(filterValue,param){notification.appParamsValue[param]=filterValue,sendNotification(notification)}(tag.configuration.inputText,null===(_tag$configuration$ap2=tag.configuration.appParam)||void 0===_tag$configuration$ap2?void 0:_tag$configuration$ap2.value)},children:(0,jsx_runtime.jsx)(Filter_InputTypeText,{tag:tag})}):"listeDeroulanteJson"===tag.type||"listeDeroulanteDataSource"===tag.type?(0,jsx_runtime.jsx)(Filter_SelectOptionFilter,{onSendNotification:sendNotification,onReset:function onReset(){return function resetFilter(filter,index){resetAppParams(filter),_ref5.current[index].resetSelection()}(tag,index)},tag:tag,ref:function ref(el){return _ref5.current[index]=el}}):""})]},index)}))})})})),Filter_Filters=Filters,context=__webpack_require__("./src/services/context.js"),Customizer=function(_React$PureComponent){(0,inherits.Z)(Customizer,_React$PureComponent);var _super=(0,createSuper.Z)(Customizer);function Customizer(props){var _this;return(0,classCallCheck.Z)(this,Customizer),(_this=_super.call(this,props)).setAppParams=function(){var filters=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(filters||[]).forEach((function(filter){var _filter$configuration,_filter$configuration2;if("datePickerAvance"==filter.type&&filter.configuration.appParam){var params=filter.configuration.appParam;NotificationService.B[params[0].value]=formatDate(filter.configuration.startDateRange),NotificationService.B[params[1].value]=formatDate(filter.configuration.endDateRange)}else"inputText"==filter.type&&null!==(_filter$configuration=filter.configuration)&&void 0!==_filter$configuration&&null!==(_filter$configuration2=_filter$configuration.appParam)&&void 0!==_filter$configuration2&&_filter$configuration2.value&&(NotificationService.B[filter.configuration.appParam.value]=filter.configuration.inputText)}))},_this.am4themes_dashboard=function(target){var _appearance$seriesCol,appearance=_this.props.appearance;if(target instanceof core.ColorSet&&(null==appearance||null===(_appearance$seriesCol=appearance.seriesColors)||void 0===_appearance$seriesCol?void 0:_appearance$seriesCol.length)>0&&(target.list=appearance.seriesColors.map((function(serieColor){return core.color(serieColor)}))),target instanceof core.InterfaceColorSet&&null!=appearance&&appearance.widgetBackground){var fgColor=core.color(null==appearance?void 0:appearance.widgetBackground).alternative;target.setFor("background",core.color(null==appearance?void 0:appearance.widgetBackground)),target.setFor("text",fgColor),target.setFor("grid",fgColor)}},_this.onWindowResize=function(){if(_this.mounted){var width=.95*window.innerWidth;_this.setState({width:width})}},_this.onLayoutChange=function(_,layouts){_this.setState({layouts:layouts})},_this.Widgets=function(){var widgets=_this.state.widgets,height={height:"100%"};return Object.keys(widgets).map((function(key){var _widgets$key$widget,_widgets$key$widget$s;return(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("div",{style:height,children:(0,jsx_runtime.jsx)(WidgetWrapper.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)({},widgets[key]),{},{showTitle:-1==["Image","Text"].indexOf(null===(_widgets$key$widget=widgets[key].widget)||void 0===_widgets$key$widget||null===(_widgets$key$widget$s=_widgets$key$widget.stWidget)||void 0===_widgets$key$widget$s?void 0:_widgets$key$widget$s.type)}))})},key)}))},_this.state={layouts:{},widgets:[],width:1200,widgetList:{},currentWidget:{},showWidgetEditor:!1},_this}return(0,createClass.Z)(Customizer,[{key:"componentDidMount",value:function componentDidMount(){this.setAppParams(this.props.filters),this.setState({widgets:this.props.widgets,layouts:this.props.layouts}),this.mounted=!0,window.addEventListener("resize",this.onWindowResize),this.onWindowResize(),core.useTheme(this.am4themes_dashboard)}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){this.props.widgets==prevProps.widgets&&this.props.layouts==prevProps.layouts||this.setState({widgets:this.props.widgets,layouts:this.props.layouts}),this.props.appearance!=prevProps.appearance&&core.useTheme(this.am4themes_dashboard)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.mounted=!1,window.removeEventListener("resize",this.onWindowResize)}},{key:"render",value:function render(){var _this$props=this.props,cols=_this$props.cols,breakpoints=_this$props.breakpoints,rowHeight=_this$props.rowHeight,width=_this$props.size.width,layouts=this.state.layouts;return(0,jsx_runtime.jsxs)(context.J,{children:[(0,jsx_runtime.jsx)(react.Suspense,{fallback:(0,jsx_runtime.jsx)("div",{}),children:(0,jsx_runtime.jsx)(Filter_Filters,{widgets:this.props.widgets,filters:this.props.filters})}),(0,jsx_runtime.jsx)("div",{className:"row m-auto",children:(0,jsx_runtime.jsx)(react_grid_layout.Responsive,{width:width,layouts:layouts,cols:cols,breakpoints:breakpoints,onLayoutChange:this.onLayoutChange,isDraggable:!1,isResizable:!1,rowHeight:rowHeight,resizeHandles:[],children:this.Widgets()})})]})}}]),Customizer}(react.PureComponent);Customizer.defaultProps={className:"layout",rowHeight:200,cols:{lg:12,md:10,sm:6,xs:4,xxs:2},breakpoints:{lg:1e3,md:996,sm:768,xs:480,xxs:0}},Customizer.__docgenInfo={description:"",methods:[{name:"setAppParams",docblock:null,modifiers:[],params:[{name:"filters",type:null}],returns:null},{name:"am4themes_dashboard",docblock:null,modifiers:[],params:[{name:"target",type:null}],returns:null},{name:"onWindowResize",docblock:null,modifiers:[],params:[],returns:null},{name:"onLayoutChange",docblock:null,modifiers:[],params:[{name:"_",type:null},{name:"layouts",type:null}],returns:null},{name:"Widgets",docblock:null,modifiers:[],params:[],returns:null}],displayName:"Customizer",props:{className:{defaultValue:{value:"'layout'",computed:!1},type:{name:"string"},required:!1,description:""},rowHeight:{defaultValue:{value:"200",computed:!1},type:{name:"number"},required:!1,description:""},cols:{defaultValue:{value:"{ lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 }",computed:!1},type:{name:"shape",value:{lg:{name:"number",required:!1},md:{name:"number",required:!1},sm:{name:"number",required:!1},xs:{name:"number",required:!1}}},required:!1,description:""},breakpoints:{defaultValue:{value:"{ lg: 1000, md: 996, sm: 768, xs: 480, xxs: 0 }",computed:!1},type:{name:"shape",value:{lg:{name:"number",required:!1},md:{name:"number",required:!1},sm:{name:"number",required:!1},xs:{name:"number",required:!1}}},required:!1,description:""},lg:{type:{name:"number"},required:!1,description:""},md:{type:{name:"number"},required:!1,description:""},size:{type:{name:"shape",value:{width:{name:"any",required:!1}}},required:!1,description:""},sm:{type:{name:"number"},required:!1,description:""},xs:{type:{name:"number"},required:!1,description:""},location:{type:{name:"shape",value:{pathname:{name:"string",required:!1}}},required:!1,description:""}}};var Dashboard_Customizer=(0,react_sizeme.withSize)()(Customizer);"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/Customizer.jsx"]={name:"Customizer",docgenInfo:Customizer.__docgenInfo,path:"src/components/Dashboard/Customizer.jsx"});var Dashboard=function Dashboard(props){var _useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),widgets=_useState2[0],setWidgets=_useState2[1],_useState3=(0,react.useState)({}),_useState4=(0,slicedToArray.Z)(_useState3,2),layouts=_useState4[0],setLayouts=_useState4[1],_useState5=(0,react.useState)([]),_useState6=(0,slicedToArray.Z)(_useState5,2),filters=_useState6[0],setFilters=_useState6[1],dashboardId=props.id,fetchFilters=function fetchFilters(){(function getDashboardFilter(dashboardId){var options={method:resources.lD.filter.getAll.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.filter.getAll.resource,"/").concat(dashboardId)};return(0,axios.Z)(options).then((function(res){return res.data})).catch((function(err){return err}))})(dashboardId).then((function(dashboardFilters){var filters=(dashboardFilters||[]).map((function(filter){var _filter$configuration;if("datePickerAvance"==filter.type&&"CUSTOM_RANGE"!=(null===(_filter$configuration=filter.configuration)||void 0===_filter$configuration?void 0:_filter$configuration.dateRangeType)){var _deductDateRangeFromT=function deductDateRangeFromType(type){var startDate=dayjs_min().toDate(),endDate=dayjs_min().toDate();switch(type){case"LAST_7_DAYS":startDate=dayjs_min().subtract(6,"days").toDate();break;case"LAST_30_DAYS":startDate=dayjs_min().subtract(29,"days").toDate();break;case"THIS_MONTH":startDate=dayjs_min().startOf("month").toDate(),endDate=dayjs_min().endOf("month").toDate();break;case"LAST_MONTH":startDate=dayjs_min().subtract(1,"month").startOf("month").toDate(),endDate=dayjs_min().subtract(1,"month").endOf("month").toDate()}return{startDate:startDate,endDate:endDate}}(filter.configuration.dateRangeType),startDate=_deductDateRangeFromT.startDate,endDate=_deductDateRangeFromT.endDate;filter.configuration.startDateRange=startDate,filter.configuration.endDateRange=endDate}return filter}));setFilters(filters)}))};return(0,react.useEffect)((function(){window.dbr_env=props.env,console.log("=====",window.dbr_env,props.env),props.id&&(!function fetchWidgets(){(0,dashboard.h)(dashboardId).then((function(dashboardWidgets){var _dashboardWidgets$lay=dashboardWidgets.layouts,layouts=void 0===_dashboardWidgets$lay?{}:_dashboardWidgets$lay,_dashboardWidgets$wid=dashboardWidgets.widgets,widgets=void 0===_dashboardWidgets$wid?[]:_dashboardWidgets$wid,widgetsObject=(dashboardWidgets.appearance,{});widgets.forEach((function(widget){var _widget$stWidget;widget&&widget._id&&"publish"===widget.status&&(null!=widget&&null!==(_widget$stWidget=widget.stWidget)&&void 0!==_widget$stWidget&&_widget$stWidget.config&&"object"!=typeof widget.stWidget.config&&(widget.config=JSON.parse((null==widget?void 0:widget.stWidget.config)||widget.config)),widgetsObject[widget._id]={widget:widget})})),setWidgets(widgetsObject),setLayouts(layouts)}))}(),fetchFilters())}),[props.id,props.env]),(0,jsx_runtime.jsx)("div",{className:"container-fluid no-breadcrumbs page-dashboard",children:(0,jsx_runtime.jsx)(Dashboard_Customizer,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{dashboardID:dashboardId,widgets:widgets,layouts:layouts,filters:filters}))})};Dashboard.__docgenInfo={description:"",methods:[],displayName:"Dashboard",props:{id:{type:{name:"string"},required:!0,description:""},env:{type:{name:"enum",value:[{value:"'local'",computed:!1},{value:"'demo'",computed:!1},{value:"'sandbox'",computed:!1}]},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/Dashboard.jsx"]={name:"Dashboard",docgenInfo:Dashboard.__docgenInfo,path:"src/components/Dashboard/Dashboard.jsx"});var Dashboard_stories={parameters:{storySource:{source:"import React from 'react';\nimport { Dashboard as DashboardContainer } from '../components/Dashboard/Dashboard';\n\n// More on default export: https://storybook.js.org/docs/react/writing-stories/introduction#default-export\nexport default {\n  title: 'Components/Dashboard',\n  component: DashboardContainer,\n  // More on argTypes: https://storybook.js.org/docs/react/api/argtypes\n  argTypes: {\n    id: {\n      description: 'dashboard id',\n      type: { name: 'string', required: true },\n      control: {\n        type: 'text'\n      }\n    },\n    env: {\n      description: 'dbr environment',\n      options: ['local', 'demo', 'sandbox'],\n      type: { name: 'string', required: false },\n      control: {\n        type: 'select'\n      }\n    }\n  },\n};\n\nconst Template = (args) => <DashboardContainer {...args} />;\n\nexport const Dashboard = Template.bind({});\nDashboard.args = {\n  id: '',\n};\n",locationsMap:{dashboard:{startLoc:{col:17,line:28},endLoc:{col:59,line:28},startBody:{col:17,line:28},endBody:{col:59,line:28}}}}},title:"Components/Dashboard",component:Dashboard,argTypes:{id:{description:"dashboard id",type:{name:"string",required:!0},control:{type:"text"}},env:{description:"dbr environment",options:["local","demo","sandbox"],type:{name:"string",required:!1},control:{type:"select"}}}},Dashboard_stories_Dashboard=function Template(args){return(0,jsx_runtime.jsx)(Dashboard,(0,objectSpread2.Z)({},args))}.bind({});Dashboard_stories_Dashboard.args={id:""},Dashboard_stories_Dashboard.parameters=(0,objectSpread2.Z)({storySource:{source:"(args) => <DashboardContainer {...args} />"}},Dashboard_stories_Dashboard.parameters)},"./src/stories/DashboardItem.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Item:function(){return Item}});var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_components_Dashboard_DashboardList_DashboardItem__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/components/Dashboard/DashboardList/DashboardItem.jsx")),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");__webpack_exports__.default={parameters:{storySource:{source:"import React from 'react';\nimport DashboardItem from '../components/Dashboard/DashboardList/DashboardItem';\n\nexport default {\n  title: 'Components/Dashboard',\n  component: DashboardItem,\n  argTypes: {\n    name: {\n      description: 'dashboard name',\n      type: { name: 'string' },\n      control: {\n        type: 'text'\n      }\n    },\n    description: {\n      description: 'dashboard description',\n      type: { name: 'string' },\n      control: {\n        type: 'text'\n      }\n    },\n    updatedAt: {\n      description: 'last update',\n      type: { name: 'string' },\n      control: {\n        type: 'text'\n      }\n    },\n    onClick: {\n      description: 'func',\n      type: { name: 'func', required: false },\n      control: {\n        type: 'func'\n      }\n    }\n  },\n};\n\nconst Template = (args) => <DashboardItem {...args} />;\n\nexport const Item = Template.bind({});\nItem.args = {\n  name: 'lorem ipsum',\n  description: 'consectetur adipiscing',\n  updatedAt: '2021-12-23T10:51:29.452Z',\n};\n",locationsMap:{item:{startLoc:{col:17,line:39},endLoc:{col:54,line:39},startBody:{col:17,line:39},endBody:{col:54,line:39}}}}},title:"Components/Dashboard",component:_components_Dashboard_DashboardList_DashboardItem__WEBPACK_IMPORTED_MODULE_1__.Z,argTypes:{name:{description:"dashboard name",type:{name:"string"},control:{type:"text"}},description:{description:"dashboard description",type:{name:"string"},control:{type:"text"}},updatedAt:{description:"last update",type:{name:"string"},control:{type:"text"}},onClick:{description:"func",type:{name:"func",required:!1},control:{type:"func"}}}};var Item=function Template(args){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_components_Dashboard_DashboardList_DashboardItem__WEBPACK_IMPORTED_MODULE_1__.Z,(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},args))}.bind({});Item.args={name:"lorem ipsum",description:"consectetur adipiscing",updatedAt:"2021-12-23T10:51:29.452Z"},Item.parameters=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({storySource:{source:"(args) => <DashboardItem {...args} />"}},Item.parameters)},"./src/stories/DashboardList.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{List:function(){return List},default:function(){return DashboardList_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),reactstrap_modern=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),dashboard=__webpack_require__("./src/api/dashboard/index.js"),DashboardItem=__webpack_require__("./src/components/Dashboard/DashboardList/DashboardItem.jsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),DashboardList=function DashboardList(_ref){var token=_ref.token,env=_ref.env,onClick=_ref.onClick,_useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),dashboards=_useState2[0],setDashboards=_useState2[1];return(0,react.useEffect)((function(){window.accessToken=token,window.dbr_env=env,token&&(0,dashboard.Y)().then((function(data){return setDashboards(data)}))}),[token,env]),(0,jsx_runtime.jsx)(reactstrap_modern.X2,{children:(null==dashboards?void 0:dashboards.length)>0&&dashboards.map((function(dashboard){return(0,jsx_runtime.jsx)(DashboardItem.Z,{onClick:onClick||!1,name:null==dashboard?void 0:dashboard.name,description:null==dashboard?void 0:dashboard.description,updatedAt:null==dashboard?void 0:dashboard.updatedAt},dashboard._id)}))})};DashboardList.__docgenInfo={description:"",methods:[],displayName:"DashboardList",props:{token:{type:{name:"string"},required:!0,description:""},env:{type:{name:"enum",value:[{value:"'local'",computed:!1},{value:"'demo'",computed:!1},{value:"'sandbox'",computed:!1}]},required:!1,description:""},onClick:{type:{name:"func"},required:!1,description:""}}};var DashboardList_DashboardList=DashboardList;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/DashboardList/DashboardList.jsx"]={name:"DashboardList",docgenInfo:DashboardList.__docgenInfo,path:"src/components/Dashboard/DashboardList/DashboardList.jsx"});var DashboardList_stories={parameters:{storySource:{source:"import React from 'react';\nimport DashboardList from '../components/Dashboard/DashboardList/DashboardList';\n\nexport default {\n  title: 'Components/Dashboard',\n  component: DashboardList,\n  argTypes: {\n    token: {\n      description: 'keycloack user valid token',\n      type: { name: 'string', required: true },\n      control: {\n        type: 'text'\n      }\n    },\n    env: {\n      description: 'dbr environment',\n      options: ['local', 'demo', 'sandbox'],\n      type: { name: 'string', required: false },\n      control: {\n        type: 'select'\n      }\n    },\n    onClick: {\n      description: 'func',\n      type: { name: 'func', required: false },\n      control: {\n        type: 'func'\n      }\n    }\n  },\n};\n\nconst Template = (args) => <DashboardList {...args} />;\n\nexport const List = Template.bind({});\nList.args = {\n  token: '',\n  env: 'local'\n};\n",locationsMap:{list:{startLoc:{col:17,line:33},endLoc:{col:54,line:33},startBody:{col:17,line:33},endBody:{col:54,line:33}}}}},title:"Components/Dashboard",component:DashboardList_DashboardList,argTypes:{token:{description:"keycloack user valid token",type:{name:"string",required:!0},control:{type:"text"}},env:{description:"dbr environment",options:["local","demo","sandbox"],type:{name:"string",required:!1},control:{type:"select"}},onClick:{description:"func",type:{name:"func",required:!1},control:{type:"func"}}}},List=function Template(args){return(0,jsx_runtime.jsx)(DashboardList_DashboardList,(0,objectSpread2.Z)({},args))}.bind({});List.args={token:"",env:"local"},List.parameters=(0,objectSpread2.Z)({storySource:{source:"(args) => <DashboardList {...args} />"}},List.parameters)},"./src/stories/Widget.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Widget:function(){return Widget}});var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_components_Widget_WidgetWrapper__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/components/Widget/WidgetWrapper.jsx")),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");__webpack_exports__.default={parameters:{storySource:{source:"import React from 'react';\nimport WidgetWrapper from '../components/Widget/WidgetWrapper';\n\n\n// More on default export: https://storybook.js.org/docs/react/writing-stories/introduction#default-export\nexport default {\n  title: 'Components/Widget',\n  component: WidgetWrapper,\n  // More on argTypes: https://storybook.js.org/docs/react/api/argtypes\n  argTypes: {\n    widget: {\n      description: 'widget config',\n      type: { name: 'string', required: true },\n      control: {\n        type: 'object'\n      }\n    },\n    showTitle: {\n      description: 'show or hide widget header',\n      control: { type: 'boolean' },\n    },\n\n  },\n};\n\nconst Template = (args) => <div style={{ height: '400px' }}><WidgetWrapper {...args} /></div>;\n\nexport const Widget = Template.bind({});\nWidget.args = {\n  widget: {},\n  showTitle: true\n};\n",locationsMap:{widget:{startLoc:{col:17,line:26},endLoc:{col:93,line:26},startBody:{col:17,line:26},endBody:{col:93,line:26}}}}},title:"Components/Widget",component:_components_Widget_WidgetWrapper__WEBPACK_IMPORTED_MODULE_1__.Z,argTypes:{widget:{description:"widget config",type:{name:"string",required:!0},control:{type:"object"}},showTitle:{description:"show or hide widget header",control:{type:"boolean"}}}};var Widget=function Template(args){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{style:{height:"400px"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_components_Widget_WidgetWrapper__WEBPACK_IMPORTED_MODULE_1__.Z,(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},args))})}.bind({});Widget.args={widget:{},showTitle:!0},Widget.parameters=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({storySource:{source:"(args) => <div style={{ height: '400px' }}><WidgetWrapper {...args} /></div>"}},Widget.parameters)},"./.storybook/preview.js-generated-config-entry.js":function(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,{parameters:function(){return parameters}});var ClientApi=__webpack_require__("./node_modules/@storybook/client-api/dist/esm/ClientApi.js"),esm=__webpack_require__("./node_modules/@storybook/client-logger/dist/esm/index.js"),parameters={actions:{argTypesRegex:"^on[A-Z].*"},controls:{matchers:{color:/(background|color)$/i,date:/Date$/}}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.kg.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return(0,ClientApi.$9)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return(0,ClientApi.HZ)(loader,!1)}));case"parameters":return(0,ClientApi.h1)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return(0,ClientApi.My)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return(0,ClientApi._C)(enhancer)}));case"render":return(0,ClientApi.$P)(value);case"globals":case"globalTypes":var v={};return v[key]=value,(0,ClientApi.h1)(v,!1);case"decorateStory":case"renderToDOM":return null;default:return console.log(key+" was not supported :( !")}}))},"./src/api/axios.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/axios/index.js"),axios__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__),axiosApiInstance=axios__WEBPACK_IMPORTED_MODULE_1___default().create();axiosApiInstance.interceptors.request.use(function(){var _ref=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(config){return _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return config.headers={Authorization:"Bearer ".concat(window.accessToken),Accept:"application/json"},_context.abrupt("return",config);case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),(function(error){Promise.reject(error)})),axiosApiInstance.interceptors.response.use((function(response){return response}),function(){var _ref2=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee2(error){var originalRequest;return _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(originalRequest=error.config,403!==error.response.status||originalRequest._retry){_context2.next=5;break}return originalRequest._retry=!0,axios__WEBPACK_IMPORTED_MODULE_1___default().defaults.headers.common.Authorization="Bearer "+window.accessToken,_context2.abrupt("return",axiosApiInstance(originalRequest));case 5:return _context2.abrupt("return",Promise.reject(error));case 6:case"end":return _context2.stop()}}),_callee2)})));return function(_x2){return _ref2.apply(this,arguments)}}()),__webpack_exports__.Z=axiosApiInstance},"./src/api/dashboard/index.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{h:function(){return getDashboardWidgets},Y:function(){return getDashboards}});var axios=__webpack_require__("./src/api/axios.js"),resources=__webpack_require__("./src/constants/resources.js");function getDashboards(){var options={method:resources.lD.dashboard.get.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.dashboard.get.resource)};return(0,axios.Z)(options).then((function(res){return res.data})).catch((function(err){return err}))}var getDashboardWidgets=function getDashboardWidgets(id){var options={method:resources.lD.dashboard.getDashboardsWitgets.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.dashboard.getDashboardsWitgets.resource)+"/"+id};return(0,axios.Z)(options).then((function(res){return{name:res.data.name,description:res.data.description,widgets:res.data.widgets,layouts:res.data.layouts,appearance:res.data.appearance,share:res.data.share,role:res.data.role,owner:res.data.owner}})).catch((function(err){return err}))}},"./src/components/Dashboard/DashboardList/DashboardItem.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return DashboardList_DashboardItem}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),reactstrap_modern=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),ImageListView=function ImageListView(_ref){var _Date,name=_ref.name,description=_ref.description,updatedAt=_ref.updatedAt,onClick=_ref.onClick;return(0,jsx_runtime.jsx)(reactstrap_modern.JX,{sm:"6",lg:"4",xl:"3",className:"mb-3",children:(0,jsx_runtime.jsxs)(reactstrap_modern.Zb,{children:[(0,jsx_runtime.jsxs)("div",{className:"position-relative",children:[(0,jsx_runtime.jsx)(reactstrap_modern.Mo,{top:!0,alt:name,src:"assets/images/dashboard.png",loading:"lazy"}),(0,jsx_runtime.jsx)(reactstrap_modern.Ct,{type:"button",pill:!0,color:"info",className:"position-absolute badge-top-left d-flex badge-info",onClick:onClick,children:(0,jsx_runtime.jsx)("i",{className:"simple-icon-share-alt text-one px-1"})})]}),(0,jsx_runtime.jsx)(reactstrap_modern.eW,{className:"py-3",children:(0,jsx_runtime.jsx)(reactstrap_modern.X2,{children:(0,jsx_runtime.jsxs)(reactstrap_modern.JX,{xxs:"10",className:"mb-3",children:[(0,jsx_runtime.jsx)(reactstrap_modern._R,{className:"text-mlarge mb-1 text-capitalize",children:name}),(0,jsx_runtime.jsxs)(reactstrap_modern.SK,{className:"text-muted text-one mb-0 font-weight-light",children:[description&&description.length>0?null==description?void 0:description.toLowerCase():"",(0,jsx_runtime.jsx)("br",{}),(null===(_Date=new Date(updatedAt))||void 0===_Date?void 0:_Date.toDateString())||""]})]})})})]})})};ImageListView.__docgenInfo={description:"",methods:[],displayName:"ImageListView",props:{name:{type:{name:"any"},required:!1,description:""},description:{type:{name:"string"},required:!1,description:""},updatedAt:{type:{name:"any"},required:!1,description:""}}};var DashboardList_ImageListView=react.memo(ImageListView);"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/DashboardList/ImageListView.jsx"]={name:"ImageListView",docgenInfo:ImageListView.__docgenInfo,path:"src/components/Dashboard/DashboardList/ImageListView.jsx"});var DashboardItem=function DashboardItem(props){return(0,jsx_runtime.jsx)(DashboardList_ImageListView,(0,objectSpread2.Z)({},props))};DashboardItem.__docgenInfo={description:"",methods:[],displayName:"DashboardItem",props:{name:{type:{name:"any"},required:!1,description:""},description:{type:{name:"string"},required:!1,description:""},updatedAt:{type:{name:"string"},required:!1,description:""},onClick:{type:{name:"func"},required:!1,description:""}}};var DashboardList_DashboardItem=DashboardItem;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/DashboardList/DashboardItem.jsx"]={name:"DashboardItem",docgenInfo:DashboardItem.__docgenInfo,path:"src/components/Dashboard/DashboardList/DashboardItem.jsx"})},"./src/components/Widget/GenericWidget/GenericWidget.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_assertThisInitialized_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_inherits_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_createSuper_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createSuper.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),socket_io_client__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/socket.io-client/build/esm/index.js"),constants_resources__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/constants/resources.js"),_amcharts_amcharts4_themes_animated__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@amcharts/amcharts4/themes/animated.js"),_amcharts_amcharts4_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@amcharts/amcharts4/core.js"),_amcharts_amcharts4_charts__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@amcharts/amcharts4/charts.js"),_amcharts_amcharts4_plugins_wordCloud__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@amcharts/amcharts4/plugins/wordCloud.js"),_amcharts_amcharts4_maps__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@amcharts/amcharts4/maps.js"),_amcharts_amcharts4_geodata_worldMoroccoLow__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@amcharts/amcharts4-geodata/worldMoroccoLow.js"),_amcharts_amcharts4_geodata_moroccoLow__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@amcharts/amcharts4-geodata/moroccoLow.js"),_services_NotificationService__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/services/NotificationService.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/react/jsx-runtime.js");_amcharts_amcharts4_core__WEBPACK_IMPORTED_MODULE_5__.useTheme(_amcharts_amcharts4_themes_animated__WEBPACK_IMPORTED_MODULE_4__.Z),_amcharts_amcharts4_core__WEBPACK_IMPORTED_MODULE_5__.addLicense("ch-custom-attribution");var GenericWidget=function(_PureComponent){(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_inherits_js__WEBPACK_IMPORTED_MODULE_13__.Z)(GenericWidget,_PureComponent);var _super=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_createSuper_js__WEBPACK_IMPORTED_MODULE_14__.Z)(GenericWidget);function GenericWidget(props){var _this;return(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_classCallCheck_js__WEBPACK_IMPORTED_MODULE_15__.Z)(this,GenericWidget),_this=_super.call(this,props),_this.mappingParams=[],_this.lastAppParams=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_16__.Z)({},_services_NotificationService__WEBPACK_IMPORTED_MODULE_11__.B),_this.handleNotification=function(widgetNotification){JSON.stringify(_this.lastAppParams)!=JSON.stringify(widgetNotification.appParamsValue)&&(_this.props.onReceiveNotification(widgetNotification.appParamsValue),_this.lastAppParams=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_16__.Z)({},widgetNotification.appParamsValue))},_this.exportChart=function(type){_this.chart.exporting.export(type)},_this.initializeWidget=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_17__.Z)(_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(){var parsedConfig,initChart,_initChart,initChartParams;return _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:try{_this.setDashboardId();try{parsedConfig=_this.jsonParser(_this.props.widget.config),_this.props.widget.config=parsedConfig}catch(er){console.log(er)}_this.props.widget.config.hasOwnProperty("init")&&(initChart=eval(_this.props.widget.config.init),initChart(_this.props),_this.chart=_amcharts_amcharts4_core__WEBPACK_IMPORTED_MODULE_5__.createFromConfig(_this.props.widget.config,_this.props.widget._id,_this.props.widget.type)),_this.props.widget.config.hasOwnProperty("initChart")&&(_initChart=eval(_this.props.widget.config.initChart),initChartParams={chart:_this.chart,props:_this.props,am4core:_amcharts_amcharts4_core__WEBPACK_IMPORTED_MODULE_5__,am4charts:_amcharts_amcharts4_charts__WEBPACK_IMPORTED_MODULE_6__,worldMoroccoLow:_amcharts_amcharts4_geodata_worldMoroccoLow__WEBPACK_IMPORTED_MODULE_9__.Z,moroccoLow:_amcharts_amcharts4_geodata_moroccoLow__WEBPACK_IMPORTED_MODULE_10__.Z,am4maps:_amcharts_amcharts4_maps__WEBPACK_IMPORTED_MODULE_8__,am4plugins_wordCloud:_amcharts_amcharts4_plugins_wordCloud__WEBPACK_IMPORTED_MODULE_7__},_this.chart=_initChart(initChartParams)),_this.chart&&(_this.chart.dispatchEvent=_this.dispathWidgetEvent.bind((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_assertThisInitialized_js__WEBPACK_IMPORTED_MODULE_18__.Z)(_this)))}catch(error){console.log(error)}case 1:case"end":return _context.stop()}}),_callee)}))),_this.mappingParams=_this.props.widget.mappingParams,_this.subscription=_services_NotificationService__WEBPACK_IMPORTED_MODULE_11__.O.getNotification().subscribe((function(widgetNotification){_this.handleNotification(widgetNotification)})),_this.socket||(_this.socket=(0,socket_io_client__WEBPACK_IMPORTED_MODULE_2__.ZP)(constants_resources__WEBPACK_IMPORTED_MODULE_3__.gs,{path:"/back/socket",transports:["websocket","polling"]}),_this.socket.on("connect",(function(socket){_services_NotificationService__WEBPACK_IMPORTED_MODULE_11__.O.registerWidgetSocket(_this.socket)})),_this.socket.on("RECEIVE_NOTIFICATION",(function(notification){_services_NotificationService__WEBPACK_IMPORTED_MODULE_11__.O.isWidgetRegistredInSocketPool(notification.widgetSocketId)||_services_NotificationService__WEBPACK_IMPORTED_MODULE_11__.O.sendNotification(notification.widgetNotification)}))),_this}return(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_createClass_js__WEBPACK_IMPORTED_MODULE_19__.Z)(GenericWidget,[{key:"setDashboardId",value:function setDashboardId(){}},{key:"renderWidget",value:function renderWidget(widgetNotification){if(widgetNotification&&null!=widgetNotification)try{if(this.props.widget.config=this.jsonParser(this.props.widget.config),this.props.widget.config.hasOwnProperty("render")){var render=eval(this.props.widget.config.render),renderParams={chart:this.chart,props:this.props,notification:widgetNotification,am4core:_amcharts_amcharts4_core__WEBPACK_IMPORTED_MODULE_5__,am4charts:_amcharts_amcharts4_charts__WEBPACK_IMPORTED_MODULE_6__,worldMoroccoLow:_amcharts_amcharts4_geodata_worldMoroccoLow__WEBPACK_IMPORTED_MODULE_9__.Z,moroccoLow:_amcharts_amcharts4_geodata_moroccoLow__WEBPACK_IMPORTED_MODULE_10__.Z,am4maps:_amcharts_amcharts4_maps__WEBPACK_IMPORTED_MODULE_8__,am4plugins_wordCloud:_amcharts_amcharts4_plugins_wordCloud__WEBPACK_IMPORTED_MODULE_7__};this.chart=render(renderParams),this.chart.dispatchEvent=this.dispathWidgetEvent.bind(this)}}catch(er){console.log(er)}}},{key:"notifyAllWidgets",value:function notifyAllWidgets(widgetNotification){_services_NotificationService__WEBPACK_IMPORTED_MODULE_11__.O.sendNotification(widgetNotification),this.socket.emit("SEND_NOTIFICATION",{widgetSocketId:this.socket.id,widgetNotification:widgetNotification})}},{key:"dispathWidgetEvent",value:function dispathWidgetEvent(widgetParam){if(this.mappingParams&&0!=this.mappingParams.length){var widgetNotification={fromWidgetKey:this.props.widget._id,appParamsValue:{}};this.mappingParams.forEach((function(item){widgetNotification.appParamsValue[item.appParam]=widgetParam[item.responseParam]})),this.notifyAllWidgets(widgetNotification)}}},{key:"componentDidMount",value:function componentDidMount(){this.initializeWidget(),this.props.exportChart.current=this.exportChart,this.props.initChart.current=this.initializeWidget}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}},{key:"jsonParser",value:function jsonParser(toParse){var parsed=toParse;return"string"==typeof toParse&&(parsed=JSON.parse(toParse)),"string"==typeof parsed?this.jsonParser(parsed):parsed}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){this.props.widget.data!=prevProps.widget.data&&this.renderWidget({appParamsValue:this.lastAppParams})}},{key:"render",value:function render(){var _this$props$widget,_this$props$widget$da;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_12__.jsx)("div",{id:this.props.widget._id,className:"w-100 h-100 ".concat((null===(_this$props$widget=this.props.widget)||void 0===_this$props$widget||null===(_this$props$widget$da=_this$props$widget.data)||void 0===_this$props$widget$da?void 0:_this$props$widget$da.length)>0?"":"d-none")},this.props.widget._id)}}]),GenericWidget}(react__WEBPACK_IMPORTED_MODULE_1__.PureComponent);GenericWidget.__docgenInfo={description:"",methods:[{name:"handleNotification",docblock:null,modifiers:[],params:[{name:"widgetNotification",type:null}],returns:null},{name:"setDashboardId",docblock:null,modifiers:[],params:[],returns:null},{name:"renderWidget",docblock:null,modifiers:[],params:[{name:"widgetNotification",type:null}],returns:null},{name:"notifyAllWidgets",docblock:null,modifiers:[],params:[{name:"widgetNotification",type:null}],returns:null},{name:"dispathWidgetEvent",docblock:null,modifiers:[],params:[{name:"widgetParam",type:null}],returns:null},{name:"exportChart",docblock:null,modifiers:[],params:[{name:"type",type:null}],returns:null},{name:"jsonParser",docblock:null,modifiers:[],params:[{name:"toParse",type:null}],returns:null},{name:"initializeWidget",docblock:null,modifiers:["async"],params:[],returns:null}],displayName:"GenericWidget"},__webpack_exports__.Z=GenericWidget,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Widget/GenericWidget/GenericWidget.jsx"]={name:"GenericWidget",docgenInfo:GenericWidget.__docgenInfo,path:"src/components/Widget/GenericWidget/GenericWidget.jsx"})},"./src/components/Widget/WidgetWrapper.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return Widget_WidgetWrapper}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),react=__webpack_require__("./node_modules/react/index.js"),reactstrap_modern=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),esm=__webpack_require__("./node_modules/@react-google-maps/api/dist/esm.js");function map_worker(){onmessage=function onmessage(e){var _e$data=e.data,action=_e$data.action,stratificationTree=_e$data.stratificationTree;if("getNodesWithoutParent"===action){var nodesWithoutParent=getNodesWithoutParent(stratificationTree);postMessage({action:action,nodesWithoutParent:nodesWithoutParent})}};var getNodesWithoutParent=function getNodesWithoutParent(stratificationTree){var nodesIds=stratificationTree.map((function(_ref){return _ref._id}));return stratificationTree.filter((function(_ref2){var parent=_ref2.parent;return!nodesIds.includes(parent)})).map((function(_ref3){return _ref3.parent}))}}var createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),WebWorker=(0,createClass.Z)((function WebWorker(worker){(0,classCallCheck.Z)(this,WebWorker);var code=worker.toString(),blob=new Blob(["(".concat(code,")()")]);return new Worker(URL.createObjectURL(blob))})),mapStyles_namespaceObject=JSON.parse('[{"featureType":"all","elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"administrative.country","stylers":[{"visibility":"off"}]},{"featureType":"administrative.province","stylers":[{"visibility":"on"}]},{"featureType":"administrative.locality","stylers":[{"visibility":"on"}]}]'),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),options={fillOpacity:.4,strokeColor:"#000",strokeOpacity:1,strokeWeight:1};function PolygonWrapper(props){var node=props.node,handleMarkerClick=props.handleMarkerClick,_useState=(0,react.useState)(node.fillColor||"#000"),_useState2=(0,slicedToArray.Z)(_useState,2),fillColor=_useState2[0],setFillColor=_useState2[1],polygonOptions=(0,objectSpread2.Z)((0,objectSpread2.Z)({},options),{},{fillColor:fillColor}),coords=node.polygonCoordinates.map((function(l){return{lat:l[1],lng:l[0]}}));return(0,jsx_runtime.jsx)(esm.mg,{paths:coords,onClick:function onClick(){handleMarkerClick(node)},onMouseOver:function handleMouseOver(){setFillColor("#e9e7a8")},onMouseOut:function handleMouseOut(){setFillColor(node.fillColor||"#000")},options:polygonOptions})}PolygonWrapper.__docgenInfo={description:"",methods:[],displayName:"PolygonWrapper",props:{node:{type:{name:"object"},required:!1,description:""},handleMarkerClick:{type:{name:"func"},required:!1,description:""}}};var components_PolygonWrapper=PolygonWrapper;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Widget/Map/components/PolygonWrapper.jsx"]={name:"PolygonWrapper",docgenInfo:PolygonWrapper.__docgenInfo,path:"src/components/Widget/Map/components/PolygonWrapper.jsx"});__webpack_require__("./node_modules/react-query/es/index.js");var axios=__webpack_require__("./src/api/axios.js"),resources=__webpack_require__("./src/constants/resources.js");function getWidgetNodes(widget){var options={method:resources.lD.nodes.get.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.nodes.get.resource,"?widget=").concat(widget)};return(0,axios.Z)(options).then((function(res){return res.data})).catch((function(err){return err}))}var build_esm=__webpack_require__("./node_modules/socket.io-client/build/esm/index.js"),NotificationService=__webpack_require__("./src/services/NotificationService.js"),services_context=__webpack_require__("./src/services/context.js"),Tree_useNodeNotification=function useNodeNotification(_ref){var _map$id,_map$id2,subscription,socket,widgetId=_ref.widgetId,treeId=_ref.treeId,_useContext=(0,react.useContext)(services_context.h),map=_useContext.map,widgets=_useContext.dashboard.widgets,setMapData=_useContext.setMapData,id=treeId||widgetId,currentNodeId=(null===(_map$id=map[id])||void 0===_map$id?void 0:_map$id.currentNodeId)||null,data=(null===(_map$id2=map[id])||void 0===_map$id2?void 0:_map$id2.data)||[];(0,react.useEffect)((function(){return subscription=NotificationService.O.getNotification().subscribe((function(notification){handleNotification(widgets,notification,data)})),createSocket(),function(){subscription&&subscription.unsubscribe()}}),[data,widgets]),(0,react.useEffect)((function(){var _Object$keys;if(currentNodeId){var node=data.find((function(_ref2){var _id=_ref2._id;return currentNodeId==_id}));if(node){var appParamsValue={};for(var key in node.metaData||{})appParamsValue[key]=node.metaData[key]+"".split(",").map((function(i){return i.trim()}))[0];node.applicationParam&&(appParamsValue[node.applicationParam]=node.name),!((null===(_Object$keys=Object.keys(appParamsValue))||void 0===_Object$keys?void 0:_Object$keys.length)>0)||treeId&&widgets[treeId]||notifyAllWidgets({fromWidgetKey:widgetId,appParamsValue:appParamsValue})}}}),[currentNodeId]);var createSocket=function createSocket(widgets){return(socket=(0,build_esm.ZP)(resources.gs,{path:"/back/socket",transports:["websocket","polling"]})).on("connect",(function(){NotificationService.O.registerWidgetSocket(socket)})),socket.on("RECEIVE_NOTIFICATION",(function(notification){notification.widgetSocketId!=socket.id&&(NotificationService.O.isWidgetRegistredInSocketPool(notification.widgetSocketId)||handleNotification(widgets,notification.widgetNotification,data))})),socket},handleNotification=function handleNotification(widgets,notification,nodes){if(!(widgets&&treeId&&widgets[treeId])&&notification.appParamsValue&&notification.fromWidgetKey!=widgetId){var appParams=notification.appParamsValue,selectedNodes=nodes.filter((function(node){var commonKeys=Object.keys(appParams).filter((function(key){return node.metaData&&node.metaData[key]}));return(null==commonKeys?void 0:commonKeys.length)>0&&commonKeys.every((function(key){return node.metaData[key]&&(""==appParams[key]||node.metaData[key].split(",").map((function(item){return item.trim()})).indexOf(appParams[key]+"")>-1)}))}));(null==selectedNodes?void 0:selectedNodes.length)>0&&setMapData(treeId||widgetId,{currentNodeId:1==selectedNodes.length?selectedNodes[0]._id:"root",mapNodes:selectedNodes,nodes:selectedNodes})}},notifyAllWidgets=function notifyAllWidgets(widgetNotification){NotificationService.O.sendNotification(widgetNotification),socket||(socket=createSocket(widgets)),socket.emit("SEND_NOTIFICATION",{widgetSocketId:socket.id,widgetNotification:widgetNotification})};return{currentNodeId:currentNodeId,notification:!0}},_excluded=["children","treeId"],_excluded2=["setMapData"],defaultMapOptions={styles:mapStyles_namespaceObject,disableDefaultUI:!0,gestureHandling:"auto",mapTypeId:"satellite"},listNode={},Breadcrumb=[],stratificationNodes={},containerStyle={height:"calc(100% - 42px)",width:"100%",borderRadius:"0 0 0.4rem 0.4rem"},calculateBounds=function calculateBounds(positions){return positions&&positions[0]&&positions[0].polygonCoordinates&&positions[0].polygonCoordinates.length>0?function calculatePolygonBounds(listNode){if(listNode){var bounds=new window.google.maps.LatLngBounds;return listNode.forEach((function(_ref){for(var polygonCoordinates=_ref.polygonCoordinates,i=0;i<polygonCoordinates.length;i++){var latLng=new window.google.maps.LatLng(polygonCoordinates[i].lat||polygonCoordinates[i][1],polygonCoordinates[i].lng||polygonCoordinates[i][0]);bounds.extend(latLng)}})),bounds}}(positions):function calculateMarkerBounds(positions){if(positions&&positions[0]){for(var bounds=new window.google.maps.LatLngBounds,i=0;i<positions.length;i++){var latLng=new window.google.maps.LatLng(positions[i].lat,positions[i].lng);bounds.extend(latLng)}return bounds}}(positions)},map=null,MapComponents=function MapComponents(_ref){var _context$map$treeId,_context$map$treeId2,handleMarkerClick=_ref.handleMarkerClick,setBreadcrumb=_ref.setBreadcrumb,getNodeAncestors=_ref.getNodeAncestors,treeId=_ref.treeId;map=(0,esm.YP)();var context=(0,react.useContext)(services_context.h),nodes=(null==context||null===(_context$map$treeId=context.map[treeId])||void 0===_context$map$treeId?void 0:_context$map$treeId.mapNodes)||[],currentNodeId=(null==context||null===(_context$map$treeId2=context.map[treeId])||void 0===_context$map$treeId2?void 0:_context$map$treeId2.currentNodeId)||null,_useState=(0,react.useState)({}),_useState2=(0,slicedToArray.Z)(_useState,2),infoVisibility=_useState2[0],setInfoVisibility=_useState2[1];(0,react.useEffect)((function(){if(map&&nodes){try{var _nodes$;map.fitBounds(calculateBounds(nodes)),1===nodes.length&&null!==(_nodes$=nodes[0])&&void 0!==_nodes$&&_nodes$.kmzUrl&&map.setZoom(map.getZoom()-3)}catch(e){mapContentKey="MAP_KEY_2",console.log("error",e)}setBreadcrumb(getNodeAncestors(currentNodeId))}}),[nodes]);var ShowKmlLayers=function ShowKmlLayers(node){return(0,jsx_runtime.jsx)(esm.Cs,{url:node.kmzUrl,onClick:function onClick(){handleMarkerClick(node)},options:{preserveViewport:!0,suppressInfoWindows:!0}})},ShowMarkers=function ShowMarkers(marker){return(0,jsx_runtime.jsx)(esm.Jx,{position:{lat:marker.lat,lng:marker.lng},icon:marker.icon,onClick:function onClick(){marker.setInfoVisibility((0,defineProperty.Z)({},marker._id,!0)),handleMarkerClick(marker)},children:infoVisibility[marker._id]&&(0,jsx_runtime.jsx)(esm.nx,{children:(0,jsx_runtime.jsx)("h6",{children:marker.name})})})},ShowPolygon=function ShowPolygon(marker){return(0,jsx_runtime.jsx)(components_PolygonWrapper,{node:marker,handleMarkerClick:handleMarkerClick})},Markers=react.useMemo((function(){return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:nodes&&nodes.map((function(marker){return marker?marker.polygonCoordinates&&marker.polygonCoordinates.length>0?(0,jsx_runtime.jsx)(ShowPolygon,(0,objectSpread2.Z)({},marker),marker._id):marker.kmzUrl?(0,jsx_runtime.jsx)(ShowKmlLayers,(0,objectSpread2.Z)({},marker),marker._id):(0,jsx_runtime.jsx)(ShowMarkers,(0,objectSpread2.Z)((0,objectSpread2.Z)({},marker),{},{infoVisibility:infoVisibility,setInfoVisibility:setInfoVisibility}),marker._id):null}))})}),[nodes]);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Markers})},MapBreadcrumb=function MapBreadcrumb(_ref2){var handleMarkerClick=_ref2.handleMarkerClick,showNewStratificationOnMap=_ref2.showNewStratificationOnMap,rootNodesIds=_ref2.rootNodesIds,breadcrumb=_ref2.breadcrumb;(0,react.useEffect)((function(){showNewStratificationOnMap(rootNodesIds)}),[rootNodesIds]);var onFirstBreadcrumbClick=react.useCallback((function(){showNewStratificationOnMap("root")}),[rootNodesIds]);return Breadcrumb=breadcrumb&&breadcrumb.map((function(node,index){return breadcrumb.length-1===index?(0,jsx_runtime.jsx)("li",{className:"breadcrumb-item-map active",children:(0,jsx_runtime.jsx)("button",{type:"button",className:"btn btn-sm btn-link",onClick:function onClick(){handleMarkerClick(node)},children:node.name||"Unknown"})},Math.random()):(0,jsx_runtime.jsx)("li",{className:"breadcrumb-item-map",children:(0,jsx_runtime.jsx)("button",{type:"button",className:"btn btn-sm btn-link",onClick:function onClick(){handleMarkerClick(node)},children:node.name||"Unknown"})},Math.random())})),(0,jsx_runtime.jsxs)("ol",{className:"breadcrumb bread-map",children:[(0,jsx_runtime.jsx)("li",{className:"bread-map-left-icon",children:(0,jsx_runtime.jsx)("i",{className:"simple-icon-map"})}),(0,jsx_runtime.jsx)("li",{className:"breadcrumb-item-map-map",children:(0,jsx_runtime.jsx)("button",{type:"button",className:"btn btn-sm btn-link",onClick:onFirstBreadcrumbClick,children:"Home"})}),Breadcrumb]})};function MapHOC(_ref3){var children=_ref3.children,treeId=_ref3.treeId,props=(0,objectWithoutProperties.Z)(_ref3,_excluded),setMapData=(0,react.useContext)(services_context.h).setMapData,getNodeAncestorsRecursive=function getNodeAncestorsRecursive(node,list){node&&(stratificationNodes[node.parent]&&getNodeAncestorsRecursive(stratificationNodes[node.parent],list),list.push(node))},getNodeAncestors=function getNodeAncestors(nodeId){var bcrumb=[];return getNodeAncestorsRecursive(stratificationNodes[nodeId],bcrumb),bcrumb},updateMapMarkers=function updateMapMarkers(currentNodesIds){var _stratificationNodes,flatenListNode=function getListNodeToshow(currentNodesIds){if(currentNodesIds&&currentNodesIds[0]&&currentNodesIds[0]in listNode)return currentNodesIds.map((function(nodeId){return listNode[nodeId]})).flat().reduce((function(acc,node){return acc.concat(node)}),[])}(currentNodesIds)||[null===(_stratificationNodes=stratificationNodes)||void 0===_stratificationNodes?void 0:_stratificationNodes[currentNodesIds]];flatenListNode&&flatenListNode[0]&&currentNodesIds&&(setMapData(treeId,{currentNodeId:1==currentNodesIds.length?currentNodesIds[0]:"root",nodes:flatenListNode,mapNodes:flatenListNode}),props.setBreadcrumb(getNodeAncestors(currentNodesIds[0])))},showNewStratificationOnMap=function showNewStratificationOnMap(nodeIds){updateMapMarkers([].concat(nodeIds))},handleMarkerClick=function handleMarkerClick(marker){marker&&marker._id&&marker.lat&&marker.lng&&showNewStratificationOnMap(marker._id)};return react.Children.map(children,(function(child){var childProps=(0,objectSpread2.Z)((0,objectSpread2.Z)({},child.props),{},{handleMarkerClick:handleMarkerClick,showNewStratificationOnMap:showNewStratificationOnMap,getNodeAncestors:getNodeAncestors,setBreadcrumb:props.setBreadcrumb});return react.isValidElement(child)?react.cloneElement(child,childProps):child}))}var mapContentKey="MAP_KEY_1";function MapContent(_ref4){var widget=_ref4.widget;Tree_useNodeNotification({widgetId:widget._id,treeId:widget.tree._id});var _useState3=(0,react.useState)((function(){return new WebWorker(map_worker)})),mapWorkerInstance=(0,slicedToArray.Z)(_useState3,1)[0],_useContext2=(0,react.useContext)(services_context.h),setMapData=_useContext2.setMapData,other=(0,objectWithoutProperties.Z)(_useContext2,_excluded2);console.log("====== other",other);var _useLoadScript=(0,esm.Db)({googleMapsApiKey:"AIzaSyCzNqa1T_iZxs-eNClr8wyDIYzu3cdQs4Y"}),isLoaded=_useLoadScript.isLoaded,loadError=_useLoadScript.loadError,_useState5=(0,react.useState)((function(){return{lat:33.58831,lng:-7.61138}})),center=(0,slicedToArray.Z)(_useState5,1)[0],_useState7=(0,react.useState)(),_useState8=(0,slicedToArray.Z)(_useState7,2),rootNodesIds=_useState8[0],setRootNodesIds=_useState8[1],_React$useReducer=react.useReducer((function(state,action){return action}),[]),_React$useReducer2=(0,slicedToArray.Z)(_React$useReducer,2),breadcrumb=_React$useReducer2[0],dispatchBreadcrumb=_React$useReducer2[1],handleListStratification=function handleListStratification(selfParentTree){selfParentTree&&Array.isArray(selfParentTree)&&(listNode={},stratificationNodes={},selfParentTree.forEach((function(node){var parentId=node.parent||"root";if(listNode[parentId]||(listNode[parentId]=[]),node.location){var lat=node.location.coordinates[1],lng=node.location.coordinates[0];stratificationNodes[node._id]=(0,objectSpread2.Z)((0,objectSpread2.Z)({},node),{},{lat:lat,lng:lng}),listNode[parentId].push((0,objectSpread2.Z)((0,objectSpread2.Z)({},node),{},{lat:lat,lng:lng}))}})),function setInitialScope(stratificationTree){mapWorkerInstance.postMessage({action:"getNodesWithoutParent",stratificationTree:stratificationTree}),mapWorkerInstance.onmessage=function(e){var _e$data=e.data,action=_e$data.action,nodesWithoutParent=_e$data.nodesWithoutParent;if("getNodesWithoutParent"===action){var InitialRootNodesIds=nodesWithoutParent[0]?nodesWithoutParent:stratificationTree&&stratificationTree[0]&&stratificationTree[0]._id;setRootNodesIds(InitialRootNodesIds)}}}(selfParentTree))};return(0,react.useEffect)((function(){getWidgetNodes(widget.tree._id).then((function(data){handleListStratification(data);var nodesData=data.map((function(node){return node.location?(0,objectSpread2.Z)((0,objectSpread2.Z)({},node),{},{lng:node.location.coordinates[0],lat:node.location.coordinates[1]}):node}));console.log("========= nodesData",nodesData),setMapData(widget.tree._id,{fati:"mmmmmm"})}))}),[]),loadError?(0,jsx_runtime.jsx)("div",{children:"Map cannot be loaded right now, sorry."}):(0,jsx_runtime.jsxs)("div",{style:{height:"100%"},children:[(0,jsx_runtime.jsx)(MapHOC,{setBreadcrumb:dispatchBreadcrumb,treeId:widget.tree._id,children:(0,jsx_runtime.jsx)(MapBreadcrumb,{rootNodesIds:rootNodesIds,breadcrumb:breadcrumb})}),isLoaded?(0,jsx_runtime.jsx)(esm.b6,{id:"startification-map",mapContainerStyle:containerStyle,center:center,zoom:5,options:defaultMapOptions,children:(0,jsx_runtime.jsx)(MapHOC,{setBreadcrumb:dispatchBreadcrumb,treeId:widget.tree._id,children:(0,jsx_runtime.jsx)(MapComponents,{treeId:widget.tree._id})})},mapContentKey):(0,jsx_runtime.jsx)("div",{className:"loading"})]})}MapContent.__docgenInfo={description:"",methods:[],displayName:"MapContent"};var Map=MapContent;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Widget/Map/Map.jsx"]={name:"MapContent",docgenInfo:MapContent.__docgenInfo,path:"src/components/Widget/Map/Map.jsx"});var Widget_Map=Map,toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),index_esm=__webpack_require__("./node_modules/react-sortable-tree/dist/index.esm.js");__webpack_require__("./node_modules/react-sortable-tree/style.css");var SearchBar=function SearchBar(props){var _useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),showInput=_useState2[0],setShowInput=_useState2[1],selectPrevMatch=props.selectPrevMatch,selectNextMatch=props.selectNextMatch,searchFocusIndex=props.searchFocusIndex,searchFoundCount=props.searchFoundCount,onSearchChange=props.onSearchChange,searchString=props.searchString,SearchIcon=function SearchIcon(){return(0,jsx_runtime.jsx)("span",{className:"search-box__icon",onClick:function onClick(){return setShowInput(!showInput)},children:(0,jsx_runtime.jsx)("i",{className:"simple-icon-magnifier"})})};return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:showInput?(0,jsx_runtime.jsxs)("div",{className:"search-box",children:[(0,jsx_runtime.jsx)(SearchIcon,{}),(0,jsx_runtime.jsx)("input",{value:searchString,onChange:function onChange(e){return onSearchChange(e.target.value)}}),(null==searchString?void 0:searchString.length)>0&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("span",{className:"search-box__count m-1",children:[searchFoundCount>0?searchFocusIndex+1:0," / ",searchFoundCount]}),(0,jsx_runtime.jsxs)("div",{className:"search-box__controls m-1",children:[(0,jsx_runtime.jsx)("span",{onClick:selectPrevMatch,children:(0,jsx_runtime.jsx)("i",{className:"simple-icon-arrow-up"})}),(0,jsx_runtime.jsx)("span",{onClick:selectNextMatch,className:"m-1",children:(0,jsx_runtime.jsx)("i",{className:"simple-icon-arrow-down"})})]})]})]}):(0,jsx_runtime.jsx)(SearchIcon,{})})};SearchBar.__docgenInfo={description:"",methods:[],displayName:"SearchBar"};var Tree_SearchBar=SearchBar;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Widget/Tree/SearchBar.jsx"]={name:"SearchBar",docgenInfo:SearchBar.__docgenInfo,path:"src/components/Widget/Tree/SearchBar.jsx"});var TreeContent=react.memo((function(props){var currentNodeId=Tree_useNodeNotification({widgetId:props.widgetId}).currentNodeId,setMapData=(0,react.useContext)(services_context.h).setMapData,_useState=(0,react.useState)(""),_useState2=(0,slicedToArray.Z)(_useState,2),searchString=_useState2[0],setSearchString=_useState2[1],_useState3=(0,react.useState)(0),_useState4=(0,slicedToArray.Z)(_useState3,2),searchFocusIndex=_useState4[0],setSearchFocusIndex=_useState4[1],_useState5=(0,react.useState)(null),_useState6=(0,slicedToArray.Z)(_useState5,2),searchFoundCount=_useState6[0],setSearchFoundCount=_useState6[1],_useState7=(0,react.useState)([]),_useState8=(0,slicedToArray.Z)(_useState7,2),prevTreeData=_useState8[0],setPrevTreeData=_useState8[1],treeData=props.treeData,setTreeData=(props.onAddNode,props.setTreeData),_onMoveNode=props.onMoveNode;(0,react.useEffect)((function(){getWidgetNodes(props.widgetId).then((function(data){var tree=function listToTree(selfParentTree){var currentRoles=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!selfParentTree||selfParentTree.length<1)return[];var listNode={};selfParentTree.forEach((function(node){var _node$location,_node$location2;node.roles&&0!=node.roles.length&&!node.roles.some((function(role){return currentRoles.indexOf(role)>-1}))||(listNode[node._id]=(0,objectSpread2.Z)((0,objectSpread2.Z)({},node),{},{lat:null===(_node$location=node.location)||void 0===_node$location?void 0:_node$location.coordinates[1],lng:null===(_node$location2=node.location)||void 0===_node$location2?void 0:_node$location2.coordinates[0],children:node.children||[]}))}));var tree=[];Object.keys(listNode).forEach((function(id,index){if(listNode&&listNode.hasOwnProperty(id)){var mappedElem=listNode[id];mappedElem.parent&&listNode[mappedElem.parent]?listNode[mappedElem.parent].children.push(mappedElem):tree.push(mappedElem)}}));for(var i=0;i<tree.length;i++)tree[i].isRoot=!0;return tree}(data,[]);setTreeData(tree)}))}),[]),(0,react.useEffect)((function(){var _result$treeData,result=(0,index_esm.sE)({getNodeKey:getNodeKey,treeData:treeData,searchQuery:currentNodeId,searchMethod:function searchMethod(_ref){var node=_ref.node,searchQuery=_ref.searchQuery;return node._id==searchQuery},searchFocusOffset:0,expandAllMatchPaths:!0,expandFocusMatchPaths:!0});(null===(_result$treeData=result.treeData)||void 0===_result$treeData?void 0:_result$treeData.length)>0&&setTreeData(result.treeData)}),[currentNodeId]);var getNodeKey=function getNodeKey(_ref4){return _ref4.treeIndex},visibleNodesCount=(0,index_esm.vr)({treeData:treeData});return(0,jsx_runtime.jsxs)("div",{className:"wrapper",children:[(0,jsx_runtime.jsx)("div",{className:"d-flex justify-content-end align-items-center",children:(0,jsx_runtime.jsx)(Tree_SearchBar,{searchString:searchString,selectPrevMatch:function selectPrevMatch(){setSearchFocusIndex(null!==searchFocusIndex?(searchFoundCount+searchFocusIndex-1)%searchFoundCount:searchFoundCount-1)},selectNextMatch:function selectNextMatch(){setSearchFocusIndex(null!==searchFocusIndex?(searchFocusIndex+1)%searchFoundCount:0)},searchFocusIndex:searchFocusIndex,searchFoundCount:searchFoundCount,onSearchChange:setSearchString})}),(0,jsx_runtime.jsx)("div",{className:"tree-wrapper",children:(0,jsx_runtime.jsx)(index_esm.ZP,{onMoveNode:function onMoveNode(_ref5){var node=_ref5.node,nextParentNode=_ref5.nextParentNode,path=_ref5.path;_onMoveNode({node:node,nextParentNode:nextParentNode,path:path,prevTreeData:prevTreeData})},onDragStateChanged:function handleDragStateChange(_ref2){_ref2.isDragging&&setPrevTreeData(treeData)},treeData:treeData,onChange:setTreeData,rowHeight:55,canDrag:!1,canDrop:function canDrop(_ref6){var nextParent=_ref6.nextParent;return!nextParent||!nextParent.noChildren},searchQuery:searchString,style:{height:55*visibleNodesCount+20},searchFocusOffset:searchFocusIndex,searchFinishCallback:function searchFinishCallback(matches){setSearchFoundCount(matches.length),setSearchFocusIndex(matches.length>0?searchFocusIndex%matches.length:0)},isVirtualized:!0,searchMethod:function customSearchMethod(_ref3){var node=_ref3.node,searchQuery=_ref3.searchQuery;return searchQuery&&node.name&&node.name.toLowerCase().indexOf(searchQuery.toLowerCase())>-1},generateNodeProps:function generateNodeProps(rowInfo){return{title:"".concat(rowInfo.node.name),onClick:function onClick(e){return function handleNodeClick(event,node){var _node$children,_node$polygonCoordina,_node$children2,clickedItemClassName=event.target.className;if("rst__expandButton"!=clickedItemClassName&&"rst__collapseButton"!=clickedItemClassName){var nodes=[].concat((0,toConsumableArray.Z)((null===(_node$children=node.children)||void 0===_node$children?void 0:_node$children.length)>0&&0==(null===(_node$polygonCoordina=node.polygonCoordinates)||void 0===_node$polygonCoordina?void 0:_node$polygonCoordina.length)?[]:[node]),(0,toConsumableArray.Z)((null===(_node$children2=node.children)||void 0===_node$children2?void 0:_node$children2.length)>0?node.children:[]));nodes&&0!=nodes.length&&(console.log("node id",node._id),setMapData(props.widgetId,{currentNodeId:node._id,nodes:nodes,mapNodes:nodes}))}}(e,rowInfo.node)},className:currentNodeId==rowInfo.node._id?"rst__rowSearchMatch rst__rowSearchFocus":""}}})})]})})),Tree_TreeContent=TreeContent,Tree=function Tree(props){var _props$widget,_useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),treeData=_useState2[0],setTreeData=_useState2[1],widgetId=(null===(_props$widget=props.widget)||void 0===_props$widget?void 0:_props$widget._id)||"";return(0,jsx_runtime.jsx)(Tree_TreeContent,{setTreeData:setTreeData,treeData:treeData,onEditNode:function onEditNode(){},onAddNode:function onAddNode(){},onRemoveNode:function onRemoveNode(){},onMoveNode:function onMoveNode(){},widgetId:widgetId})};Tree.__docgenInfo={description:"",methods:[],displayName:"Tree"};var Tree_Tree=Tree;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Widget/Tree/Tree.jsx"]={name:"Tree",docgenInfo:Tree.__docgenInfo,path:"src/components/Widget/Tree/Tree.jsx"});var Widget_Tree=Tree_Tree,dist=__webpack_require__("./node_modules/mui-datatables/dist/index.js"),createTheme=__webpack_require__("./node_modules/@material-ui/core/esm/styles/createTheme.js"),ThemeProvider=__webpack_require__("./node_modules/@material-ui/styles/esm/ThemeProvider/ThemeProvider.js"),DataGrid=(0,react.memo)((function(_ref){var subscription,widget=_ref.widget,onReceiveNotification=_ref.onReceiveNotification,_useState=(0,react.useState)(""),_useState2=(0,slicedToArray.Z)(_useState,2),tableBodyMaxHeight=_useState2[0],_useState3=(_useState2[1],(0,react.useState)("")),_useState4=(0,slicedToArray.Z)(_useState3,2),urlParams=_useState4[0],_useState5=(_useState4[1],(0,react.useState)([])),_useState6=(0,slicedToArray.Z)(_useState5,2),data=_useState6[0],setData=_useState6[1],_useState7=(0,react.useState)(-1),_useState8=(0,slicedToArray.Z)(_useState7,2),expandableRowIndex=_useState8[0],setExpandableRowIndex=_useState8[1],columns=(widget.mappingResponseParams||[]).map((function(_ref2,index){var _widget$mappingParams,responseParam=_ref2.responseParam,widgetParam=_ref2.widgetParam;return{colIndex:index,name:responseParam,appParam:null===(_widget$mappingParams=widget.mappingParams.find((function(param){return widgetParam==param.widgetParam})))||void 0===_widget$mappingParams?void 0:_widget$mappingParams.appParam}}));(0,react.useEffect)((function(){var result=widget.data||[];return setData(result),subscription=NotificationService.O.getNotification().subscribe((function(notification){handleNotification(notification)})),function(){subscription&&subscription.unsubscribe()}}),[widget.data]);var handleNotification=function handleNotification(notification){if(onReceiveNotification(notification.appParamsValue||{}),notification&&0!=widget.mappingParams.length){var commonAppParams=widget.mappingParams.filter((function(_ref3){var appParam=_ref3.appParam;return Object.keys(notification.appParamsValue).indexOf(appParam)>-1})),rowIndex=-1;(null==commonAppParams?void 0:commonAppParams.length)>0&&(rowIndex=widget.data.findIndex((function(rowData){return commonAppParams.every((function(_ref4){var appParam=_ref4.appParam,responseParam=_ref4.responseParam;return notification.appParamsValue[appParam]==rowData[responseParam]}))}))),setExpandableRowIndex(rowIndex)}},options={filter:!0,filterType:"dropdown",responsive:"vertical",tableBodyMaxHeight:tableBodyMaxHeight,fixedHeader:!0,selectableRowsHideCheckboxes:!0,onRowClick:function handleRowClick(_,_ref5){var rowIndex=_ref5.rowIndex;if(0!=widget.mappingParams.length){var rowData=data[rowIndex],appParamsValue={};widget.mappingParams.forEach((function(_ref6){var appParam=_ref6.appParam,responseParam=_ref6.responseParam;appParamsValue[appParam]=rowData[responseParam]})),Object.keys(appParamsValue).length>0&&(setExpandableRowIndex(rowIndex),function notifyAllWidgets(widgetNotification){NotificationService.O.sendNotification(widgetNotification)}({fromWidgetKey:widget._id,appParamsValue:appParamsValue}))}}},components={ExpandButton:function ExpandButton(props){return props.dataIndex===expandableRowIndex&&urlParams?(0,jsx_runtime.jsx)(dist.Vh,(0,objectSpread2.Z)({},props)):(0,jsx_runtime.jsx)("div",{style:{width:"24px"}})}};return widget.data&&0!=widget.data.length?(0,jsx_runtime.jsx)(ThemeProvider.Z,{theme:function getMuiTheme(){return(0,createTheme.Z)({overrides:{MUIDataTable:{paper:{boxShadow:"none"}},MUIDataTableHeadCell:{fixedHeader:{backgroundColor:"#f1f2f4",padding:"10px"}},MUIDataTableSelectCell:{headerCell:{backgroundColor:"#f1f2f4"}},MUIDataTableBodyCell:{root:{padding:"6px",cursor:"pointer"}}}})}(),children:(0,jsx_runtime.jsx)(dist.ZP,{data:data,columns:columns,options:options,components:components})}):null})),Widget_DataGrid=DataGrid,process=__webpack_require__("./node_modules/process/browser.js"),isSystemWidget=function isSystemWidget(widgetType){return["Tree","DataGrid","Map","Image","Text"].indexOf(widgetType)>-1},SYSTEM_WIDGETS={Tree:{_id:"Tree",name:"Tree",type:"Tree",status:"publish",icon:""},DataGrid:{_id:"DataGrid",name:"Data grid",type:"DataGrid",status:"publish",icon:"",params:[]},Map:{_id:"Map",name:"Map",type:"Map",status:"publish",icon:""}},Widget_Image=(0,react.memo)((function(_ref){var editMode=_ref.editMode,widget=_ref.widget,onDelete=_ref.onDelete,_useState=(0,react.useState)(""),_useState2=(0,slicedToArray.Z)(_useState,2),imagePath=_useState2[0],setImagePath=_useState2[1],_useState3=(0,react.useState)(!0),_useState4=(0,slicedToArray.Z)(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];return(0,react.useEffect)((function(){setTimeout((function(){var imageUrl=function getWidgetIcon(widget){var _widget$stWidget,_SYSTEM_WIDGETS$widge,_widget$stWidget2;if("Image"==widget.stWidget.type){var extension=widget.name.slice(widget.name.lastIndexOf("."));return"".concat(process.env.REACT_APP_S3_URL).concat(widget._id).concat(extension)}return(null===(_widget$stWidget=widget.stWidget)||void 0===_widget$stWidget?void 0:_widget$stWidget.icon)||(null===(_SYSTEM_WIDGETS$widge=SYSTEM_WIDGETS[null==widget||null===(_widget$stWidget2=widget.stWidget)||void 0===_widget$stWidget2?void 0:_widget$stWidget2.type])||void 0===_SYSTEM_WIDGETS$widge?void 0:_SYSTEM_WIDGETS$widge.icon)}(widget);setImagePath(imageUrl),setLoading(!1)}),5e3)}),[]),(0,jsx_runtime.jsxs)("div",{style:loading?{}:{backgroundImage:"url(".concat(imagePath,")")},className:"widget-image",children:[editMode&&(0,jsx_runtime.jsx)("span",{className:"delete bg-danger",onClick:onDelete,children:(0,jsx_runtime.jsx)("i",{className:"simple-icon-trash"})}),loading&&(0,jsx_runtime.jsx)(reactstrap_modern.$j,{})]})})),Widget_Text=(0,react.memo)((function(_ref){var widget=_ref.widget,textRef=(0,react.useRef)(null);return(0,react.useEffect)((function(){textRef.current&&(textRef.current.innerHTML=widget.name)}),[textRef,widget.name]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)("div",{className:"pl-2 pr-2 d-flex align-items-center h-100",ref:textRef})})})),Widget_GenericWidget=__webpack_require__("./src/components/Widget/GenericWidget/GenericWidget.jsx").Z,inherits=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),createSuper=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createSuper.js"),WidgetErrorBoundary=function(_Component){(0,inherits.Z)(WidgetErrorBoundary,_Component);var _super=(0,createSuper.Z)(WidgetErrorBoundary);function WidgetErrorBoundary(props){var _this;return(0,classCallCheck.Z)(this,WidgetErrorBoundary),(_this=_super.call(this,props)).state={hasError:!1,error:""},_this}return(0,createClass.Z)(WidgetErrorBoundary,[{key:"componentDidCatch",value:function componentDidCatch(error){this.setState({error:error})}},{key:"render",value:function render(){var hasError=this.state.hasError,children=this.props.children;return hasError?(0,jsx_runtime.jsxs)("div",{className:"text-center",style:{margin:"20px auto",overflow:"auto"},children:[(0,jsx_runtime.jsx)("img",{src:"assets/images/iconwrong.svg",alt:"",title:"",style:{width:"10%"}}),(0,jsx_runtime.jsxs)("h3",{className:"text-muted m-2",children:["Désolé, une erreur innatendue s’est produite..."," "]})]}):children}}],[{key:"getDerivedStateFromError",value:function getDerivedStateFromError(){return{hasError:!0}}}]),WidgetErrorBoundary}(react.Component);WidgetErrorBoundary.__docgenInfo={description:"",methods:[],displayName:"WidgetErrorBoundary"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/errorBoundaries/WidgetErrorBoundary.jsx"]={name:"WidgetErrorBoundary",docgenInfo:WidgetErrorBoundary.__docgenInfo,path:"src/errorBoundaries/WidgetErrorBoundary.jsx"});var datasourceManager=__webpack_require__("./src/services/datasource/datasourceManager.js"),Actions_WidgetActionsMenu=(0,react.memo)((function(_ref){var onExport=_ref.onExport;return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)(reactstrap_modern.OB,{className:"btn-group",direction:"left",children:[(0,jsx_runtime.jsx)(reactstrap_modern.Z_,{tag:"span",size:"xs",children:(0,jsx_runtime.jsx)("i",{className:"simple-icon-options-vertical"})}),(0,jsx_runtime.jsx)(reactstrap_modern.h_,{children:onExport&&(0,jsx_runtime.jsxs)(reactstrap_modern.hP,{tag:"span",children:["Export",(0,jsx_runtime.jsx)("div",{className:"d-flex justify-content-center mt-1",children:(0,jsx_runtime.jsx)(reactstrap_modern.hE,{children:["png","svg","pdf","csv"].map((function(type){return(0,jsx_runtime.jsx)(reactstrap_modern.zx,{color:"dark",outline:!0,className:"border-radius p-1",onClick:function onClick(){return onExport(type)},children:type.toLocaleUpperCase()},type)}))})})]})})]})})})),Widget_NoDataFound=(0,react.memo)((function(){return(0,jsx_runtime.jsx)("div",{className:"widgetWrapper",children:(0,jsx_runtime.jsxs)("div",{className:"actionsContainer",children:[(0,jsx_runtime.jsx)("img",{src:"assets/images/nodata.svg",alt:"",title:"",style:{width:"45px"}}),(0,jsx_runtime.jsx)("h3",{className:"mt-2",children:"No data found"}),(0,jsx_runtime.jsx)("p",{className:"px-4",children:"No data to display for the selected metrics"})]})})})),WidgetWrapper=function WidgetWrapper(props){var _props$appearance,_props$appearance2,_useState=(0,react.useState)({}),_useState2=(0,slicedToArray.Z)(_useState,2),_useState3=(_useState2[0],_useState2[1],(0,react.useState)([])),_useState4=(0,slicedToArray.Z)(_useState3,2),widgetData=_useState4[0],setWidgetData=_useState4[1],_useState5=(0,react.useState)(),_useState6=(0,slicedToArray.Z)(_useState5,2),mode=_useState6[0],setMode=_useState6[1],exportChart=react.useRef(null),initChart=react.useRef(null);(0,react.useEffect)((function(){null!=initChart&&initChart.current&&initChart.current()}),[null===(_props$appearance=props.appearance)||void 0===_props$appearance?void 0:_props$appearance.widgetBackground,null===(_props$appearance2=props.appearance)||void 0===_props$appearance2?void 0:_props$appearance2.seriesColors]),(0,react.useEffect)((function(){fetchWidgetData(NotificationService.B)}),[props.widget.mappingParams,props.widget.mappingResponseParams]);var fetchWidgetData=function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var paramsValue,datasource,result,_args=arguments;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(paramsValue=_args.length>0&&void 0!==_args[0]?_args[0]:[],props.widget.datasource&&(props.widget.datasource.query||"csv_file"==props.widget.datasource.type)){_context.next=3;break}return _context.abrupt("return");case 3:return(datasource=(0,objectSpread2.Z)({},props.widget.datasource)).query&&(datasource.query.paramsValue=paramsValue),_context.next=7,(0,datasourceManager.f)(datasource);case 7:(result=_context.sent)&&0!=result.length&&"error"!=result.status?(setWidgetData(result),setMode("DataFound")):(setWidgetData([]),setMode("NoDataFound"));case 9:case"end":return _context.stop()}}),_callee)})));return function fetchWidgetData(){return _ref.apply(this,arguments)}}(),handleWidgetNotification=function handleWidgetNotification(){var paramsValue=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(props.widget.datasource){var _query$urlParams,query=props.widget.datasource.query;if(!(null!=query&&null!==(_query$urlParams=query.urlParams)&&void 0!==_query$urlParams&&_query$urlParams.length)>0)return}fetchWidgetData(paramsValue)},widget=props.widget,showTitle=props.showTitle;return widget?(0,jsx_runtime.jsx)("div",{className:"widget h-100",children:(0,jsx_runtime.jsxs)(reactstrap_modern.Zb,{style:{height:"100%"},className:"widget-card",children:[showTitle&&widget.name&&(0,jsx_runtime.jsxs)(reactstrap_modern.Ol,{className:"py-1 px-3 widget-header",children:[(0,jsx_runtime.jsxs)("div",{className:"d-flex flex flex-md-row align-items-center",children:[(0,jsx_runtime.jsx)("p",{className:"ml-2 mb-0 py-2 w-100 w-xs-100 text-sxlarge",children:widget.name}),(0,jsx_runtime.jsx)(Actions_WidgetActionsMenu,{widget:widget,onExport:isSystemWidget(widget.stWidget.type)?null:exportChart.current})]}),(0,jsx_runtime.jsx)("div",{className:"separator"})]}),(0,jsx_runtime.jsx)(reactstrap_modern.eW,{className:"p-0 position-relative h-100 overflow-auto",children:(0,jsx_runtime.jsx)(WidgetErrorBoundary,{children:(0,jsx_runtime.jsxs)(react.Suspense,{fallback:(0,jsx_runtime.jsx)("div",{className:"loading"}),children:[function loadWidget(){var widget=props.widget;if(widget.stWidget){var properties={widget:(0,objectSpread2.Z)((0,objectSpread2.Z)((0,objectSpread2.Z)({},widget.stWidget),widget),{},{data:widgetData}),onReceiveNotification:handleWidgetNotification,exportChart:exportChart,initChart:initChart};switch(widget.stWidget.type){case"Tree":return(0,jsx_runtime.jsx)(Widget_Tree,(0,objectSpread2.Z)({},properties));case"DataGrid":return(0,jsx_runtime.jsx)(Widget_DataGrid,(0,objectSpread2.Z)({},properties));case"Map":return(0,jsx_runtime.jsx)(Widget_Map,(0,objectSpread2.Z)({},properties));case"Image":return(0,jsx_runtime.jsx)(Widget_Image,(0,objectSpread2.Z)({},properties));case"Text":return(0,jsx_runtime.jsx)(Widget_Text,(0,objectSpread2.Z)({},properties));default:return(0,jsx_runtime.jsx)(Widget_GenericWidget,(0,objectSpread2.Z)({},properties))}return null}}(),"NoDataFound"===mode&&(0,jsx_runtime.jsx)(Widget_NoDataFound,{})]})})})]})}):null};WidgetWrapper.__docgenInfo={description:"",methods:[],displayName:"WidgetWrapper",props:{widget:{type:{name:"shape",value:{name:{name:"string",required:!1},env:{name:"enum",value:[{value:"'local'",computed:!1},{value:"'demo'",computed:!1},{value:"'sandbox'",computed:!1}],required:!1}}},required:!1,description:""},showTitle:{type:{name:"bool"},required:!1,description:""}}};var Widget_WidgetWrapper=WidgetWrapper;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Widget/WidgetWrapper.jsx"]={name:"WidgetWrapper",docgenInfo:WidgetWrapper.__docgenInfo,path:"src/components/Widget/WidgetWrapper.jsx"})},"./src/constants/resources.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{lD:function(){return BACKEND_API_RESOURCES},gs:function(){return BACKEND_SOCKET_API_URL},kG:function(){return getApiUrl}});var process=__webpack_require__("./node_modules/process/browser.js"),getApiUrl=function getApiUrl(){var url="http://localhost:3005";switch(window.dbr_env){case"local":url="http://localhost:3005";break;case"demo":url="http://10.16.128.43:3005";break;case"sandbox":url="https://dbr-sandbox.um6p.ma/back"}return url},BACKEND_SOCKET_API_URL=(getApiUrl(),process.env.REACT_APP_SOCKET_API_HOST),BACKEND_API_RESOURCES={filter:{getAll:{method:"GET",resource:"".concat("api","/filters"),secured:!1},get:{method:"GET",resource:"".concat("api","/filter"),secured:!1}},dashboard:{get:{method:"GET",resource:"".concat("api","/dashboards"),secured:!1},getDashboardsWitgets:{method:"GET",resource:"".concat("api","/dashboard"),secured:!1}},dashboards:{get:{method:"GET",resource:"".concat("api","/dashboards"),secured:!0}},nodes:{get:{method:"GET",resource:"".concat("api","/nodes"),secured:!0}},datasource:{fetchQuery:{method:"GET",resource:"".concat("api","/datasource/fetchQuery"),secured:!1}}}},"./src/services/NotificationService.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{B:function(){return mapParams},O:function(){return notificationService}});var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),subject=new(__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js").x),widgetSockets=[],mapParams={},notificationService={sendNotification:function sendNotification(notification){for(var _i=0,_Object$keys=Object.keys(notification.appParamsValue);_i<_Object$keys.length;_i++){var key=_Object$keys[_i],value=notification.appParamsValue[key];value&&""!=value?mapParams[key]=value:delete mapParams[key]}notification.appParamsValue=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.Z)({},mapParams),subject.next(notification)},getNotification:function getNotification(){return subject.asObservable()},registerWidgetSocket:function registerWidgetSocket(socket){socket&&widgetSockets.push(socket.id)},isWidgetRegistredInSocketPool:function isWidgetRegistredInSocketPool(widgetSocketId){return widgetSockets.indexOf(widgetSocketId)>=0}}},"./src/services/context.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{h:function(){return DbrContext},J:function(){return DbrProvider}});var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),dbrContextValue={dashboard:{dashboardId:null,widgets:[]},map:{nodes:[],data:[],status:!0,marker:{id:""},currentNodeId:null},datePicker:{dateRange:{start:(new Date).setDate(0),end:new Date}}},DbrContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(dbrContextValue),DbrProvider=function DbrProvider(props){var initialMapData={nodes:[],mapNodes:[],data:[],currentNodeId:null},initState={dashboard:{dashboardId:null,widgets:[]},map:{},setMapData:function setMapData(treeId){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};setState((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)({},state),{},{map:(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)({},state.map),{},(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},treeId,(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)({},state.map[treeId]?state.map[treeId]:initialMapData),data)))}))}},_useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initState),_useState2=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_useState,2),state=_useState2[0],setState=_useState2[1];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DbrContext.Provider,{value:state,children:props.children})};DbrProvider.__docgenInfo={description:"",methods:[],displayName:"DbrProvider"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/services/context.js"]={name:"DbrProvider",docgenInfo:DbrProvider.__docgenInfo,path:"src/services/context.js"})},"./src/services/datasource/datasourceManager.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{f:function(){return datasourceManager_fetchDatasourceQuery}});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),inherits=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),createSuper=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createSuper.js"),axios=__webpack_require__("./src/api/axios.js"),resources=__webpack_require__("./src/constants/resources.js"),fetchDatasourceQuery=function fetchDatasourceQuery(datasource){delete datasource.queries,delete datasource.owner,delete datasource.share;var options={method:resources.lD.datasource.fetchQuery.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.datasource.fetchQuery.resource),params:datasource};return(0,axios.Z)(options).then((function(res){return res.data})).catch((function(){return[]}))},process=__webpack_require__("./node_modules/process/browser.js"),Datasource=function(){function Datasource(config){(0,classCallCheck.Z)(this,Datasource),this.config=config}return(0,createClass.Z)(Datasource,[{key:"fetchData",value:function fetchData(){}}]),Datasource}(),getDatasourceFilePath=function getDatasourceFilePath(datasource){var fileName=datasource.host,extension=fileName.slice(fileName.lastIndexOf(".")),domain="s3"==datasource.storage?process.env.REACT_APP_S3_URL:process.env.REACT_APP_API_HOST+"/";return"".concat(domain).concat(datasource._id).concat(extension)},Database=function(_Datasource){(0,inherits.Z)(Database,_Datasource);var _fetchData,_super=(0,createSuper.Z)(Database);function Database(){var _this;(0,classCallCheck.Z)(this,Database);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).multiReplace=function(str,regex,replaces){return str.replace(regex,(function(x){var param=x.replace(":","");return Object.keys(replaces).includes(param)?'"'.concat(replaces[param],'"'):"''"}))},_this}return(0,createClass.Z)(Database,[{key:"fetchData",value:(_fetchData=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var _this$config$query,urlParams,paramsValue,query;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _this$config$query=this.config.query,urlParams=_this$config$query.urlParams,paramsValue=_this$config$query.paramsValue,query=(0,objectSpread2.Z)({},this.config.query),(null==urlParams?void 0:urlParams.length)>0&&(query.value=this.multiReplace(query.value,new RegExp(urlParams.map((function(i){return":".concat(i)})).join("|"),"g"),paramsValue||{})),_context.next=5,fetchDatasourceQuery((0,objectSpread2.Z)((0,objectSpread2.Z)({},this.config),{},{query:query}));case 5:return _context.abrupt("return",_context.sent);case 6:case"end":return _context.stop()}}),_callee,this)}))),function fetchData(){return _fetchData.apply(this,arguments)})}]),Database}(Datasource),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),es=__webpack_require__("./node_modules/hyperformula/es/index.js"),csvFile=function(_Datasource){(0,inherits.Z)(csvFile,_Datasource);var _fetchData,_super=(0,createSuper.Z)(csvFile);function csvFile(){var _this;(0,classCallCheck.Z)(this,csvFile);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).csvTojson=function(str){var delimiter=_this.config.fieldSeparator,titles=str.slice(0,str.indexOf("\n")).split(delimiter),rows=str.slice(str.indexOf("\n")+1).split("\n");if((null==titles?void 0:titles.length)<2||(null==rows?void 0:rows.length)<2)throw new Error("invalid file");return rows.map((function(row){var values=row.split(delimiter);return titles.reduce((function(object,curr,i){return object[curr]=values[i],object}),{})}))},_this.getFilePathResponse=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var path,request;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return path=getDatasourceFilePath(_this.config),request=new XMLHttpRequest,_context.next=4,request.open("GET",path,!1);case 4:return request.send(),_context.abrupt("return",request.response);case 6:case"end":return _context.stop()}}),_callee)}))),_this}return(0,createClass.Z)(csvFile,[{key:"fetchData",value:(_fetchData=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var csvData,fileResponse,_csvData,data,hfInstance,lastColumnIndex,_this2=this;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return csvData=[],_context2.prev=1,_context2.next=4,this.getFilePathResponse();case 4:fileResponse=_context2.sent,csvData=this.csvTojson(fileResponse),this.config.query&&(data=csvData.map((function(item){return[].concat((0,toConsumableArray.Z)(Object.values(item)),[_this2.config.query.value])})),hfInstance=es.GP.buildFromArray(data,{licenseKey:"gpl-v3"}),lastColumnIndex=(null===(_csvData=csvData)||void 0===_csvData?void 0:_csvData.length)>0?Object.keys(csvData[0]).length:0,csvData.forEach((function(item,index){item[_this2.config.query.name]=hfInstance.getCellValue({col:lastColumnIndex,row:index,sheet:0})}))),_context2.next=12;break;case 9:_context2.prev=9,_context2.t0=_context2.catch(1),console.error(_context2.t0);case 12:return _context2.abrupt("return",csvData);case 13:case"end":return _context2.stop()}}),_callee2,this,[[1,9]])}))),function fetchData(){return _fetchData.apply(this,arguments)})}]),csvFile}(Datasource),node_modules_axios=__webpack_require__("./node_modules/axios/index.js"),axios_default=__webpack_require__.n(node_modules_axios),WebService=function(_Datasource){(0,inherits.Z)(WebService,_Datasource);var _testConnection,_super=(0,createSuper.Z)(WebService);function WebService(){return(0,classCallCheck.Z)(this,WebService),_super.apply(this,arguments)}return(0,createClass.Z)(WebService,[{key:"testConnection",value:(_testConnection=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var xhr;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return(xhr=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP")).open("HEAD",this.config.host||"",!1),_context.prev=2,_context.next=5,xhr.send();case 5:return _context.abrupt("return",{status:xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"});case 8:return _context.prev=8,_context.t0=_context.catch(2),_context.abrupt("return",{status:"success"});case 11:case"end":return _context.stop()}}),_callee,this,[[2,8]])}))),function testConnection(){return _testConnection.apply(this,arguments)})},{key:"fetchData",value:function fetchData(){var _this$config$headers,url=this.config.host.replace(/\/$/,"")+"/"+this.config.query.value.replace(/^\//,"").replace(/\/$/,""),_this$config$query=this.config.query,urlParams=_this$config$query.urlParams,paramsValue=_this$config$query.paramsValue;if((null==urlParams?void 0:urlParams.length)>0&&paramsValue){var isFirstParam=!url.includes("?");url=urlParams.reduce((function(acc,param){return paramsValue.hasOwnProperty(param)&&(acc+="".concat(isFirstParam?"?":"&").concat(param,"=").concat(paramsValue[param]),isFirstParam=!1),acc}),url)}console.log("url ==>",url);var options={method:"GET",data:{},url:url};if((null===(_this$config$headers=this.config.headers)||void 0===_this$config$headers?void 0:_this$config$headers.length)>0)try{var headers=JSON.parse(this.config.headers);options.headers=headers}catch(error){console.error(error)}return axios_default()(options).then((function(res){return res.data})).catch((function(err){return{status:"error",message:err.toString()}}))}}]),WebService}(Datasource),DatasourceManager=function(){function DatasourceManager(config){(0,classCallCheck.Z)(this,DatasourceManager),["mysql","pgsql","mssql","mongo"].indexOf(config.type)>-1?this.datasource=new Database(config):"url"==config.type?this.datasource=new WebService(config):"csv_file"==config.type&&(this.datasource=new csvFile(config))}var _fetchData;return(0,createClass.Z)(DatasourceManager,[{key:"fetchData",value:(_fetchData=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.datasource.fetchData();case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee,this)}))),function fetchData(){return _fetchData.apply(this,arguments)})}]),DatasourceManager}(),datasourceManager_fetchDatasourceQuery=function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(config){var manager,result;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return manager=new DatasourceManager(config),_context2.next=3,manager.fetchData();case 3:return result=_context2.sent,_context2.abrupt("return",result);case 5:case"end":return _context2.stop()}}),_callee2)})));return function fetchDatasourceQuery(_x){return _ref.apply(this,arguments)}}()},"./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js|jsx|ts|tsx))$":function(module,__unused_webpack_exports,__webpack_require__){var map={"./stories/Dashboard.stories.jsx":"./src/stories/Dashboard.stories.jsx","./stories/DashboardItem.stories.jsx":"./src/stories/DashboardItem.stories.jsx","./stories/DashboardList.stories.jsx":"./src/stories/DashboardList.stories.jsx","./stories/Widget.stories.jsx":"./src/stories/Widget.stories.jsx"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js|jsx|ts|tsx))$"},"./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$":function(module,__unused_webpack_exports,__webpack_require__){var map={"./stories/Installation.stories.mdx":"./src/stories/Installation.stories.mdx"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$"},"./storybook-init-framework-entry.js":function(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js")},"?4f7e":function(){}},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId)};__webpack_require__.O(0,[134],(function(){return __webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/polyfills.js"),__webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/globals.js"),__webpack_exec__("./storybook-init-framework-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-docs/dist/esm/frameworks/common/config.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-docs/dist/esm/frameworks/react/config.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/react/dist/esm/client/preview/config-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-links/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-actions/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-actions/dist/esm/preset/addArgs.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-backgrounds/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-backgrounds/dist/esm/preset/addParameter.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-measure/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-outline/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./.storybook/preview.js-generated-config-entry.js"),__webpack_exec__("./generated-stories-entry.js")}));__webpack_require__.O()}]);