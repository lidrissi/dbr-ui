(self.webpackChunkdbr_ui=self.webpackChunkdbr_ui||[]).push([[179],{"./generated-stories-entry.js":function(module,__unused_webpack_exports,__webpack_require__){"use strict";module=__webpack_require__.nmd(module),(0,__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js").configure)([__webpack_require__("./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$"),__webpack_require__("./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js|jsx|ts|tsx))$")],module,!1)},"./src/stories/Installation.stories.mdx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__page:function(){return __page}});__webpack_require__("./node_modules/react/index.js");var _mdx_js_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@mdx-js/react/dist/esm.js"),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/addon-docs/dist/esm/index.js");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}const Meta=(name="Meta",function MDXDefaultShortcode(props){return console.warn("Component "+name+" was not imported, exported, or provided by MDXProvider as global scope"),(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)("div",props)});var name;const layoutProps={};function MDXContent({components:components,...props}){return(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)(Meta,{title:"Home/Installation",mdxType:"Meta"}),(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)("h1",{id:"welcome-to-dbr-ui-library"},"Welcome to DBR ui library"),(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)("p",null,"DBR ui library helps you build UI components in isolation from your app's business logic, data, and context.\nThat makes it easy to develop. "))}MDXContent.isMDXComponent=!0;const __page=()=>{throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};const componentMeta={title:"Home/Installation",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs={...componentMeta.parameters.docs||{},page:()=>(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_2__.aT,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentAnnotations:componentMeta},(0,_mdx_js_react__WEBPACK_IMPORTED_MODULE_1__.kt)(MDXContent,null))},__webpack_exports__.default=componentMeta},"./src/stories/Dashboard.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Dashboard:function(){return Dashboard_stories_Dashboard},default:function(){return Dashboard_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),dayjs_min=__webpack_require__("./node_modules/dayjs/dayjs.min.js"),formatDate=function formatDate(date){return dayjs_min(new Date(date).toISOString()).format("DD-MM-YYYY")},axios=__webpack_require__("./src/api/axios.js"),resources=__webpack_require__("./src/constants/resources.js");var dashboard=__webpack_require__("./src/api/dashboard/index.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),inherits=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),createSuper=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createSuper.js"),core=__webpack_require__("./node_modules/@amcharts/amcharts4/core.js"),react_grid_layout=__webpack_require__("./node_modules/react-grid-layout/index.js"),react_sizeme=__webpack_require__("./node_modules/react-sizeme/dist/react-sizeme.js"),WidgetWrapper=(__webpack_require__("./node_modules/react-resizable/css/styles.css"),__webpack_require__("./src/components/Widget/WidgetWrapper.jsx")),NotificationService=__webpack_require__("./src/services/NotificationService.js"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),esm=__webpack_require__("./node_modules/socket.io-client/build/esm/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),Filter_InputTypeText=(0,react.memo)((function(props){var tag=props.tag,_useState=(0,react.useState)({appParamsValue:{}}),_useState2=(0,slicedToArray.Z)(_useState,2),notification=_useState2[0],setNotification=_useState2[1],_useState3=(0,react.useState)(tag.configuration.inputText),_useState4=(0,slicedToArray.Z)(_useState3,2),text=_useState4[0],setText=_useState4[1];return(0,react.useEffect)((function(){NotificationService.O.getNotification().subscribe((function(widgetNotification){var _tag$configuration,_tag$configuration$ap;setNotification(widgetNotification),null!==(_tag$configuration=tag.configuration)&&void 0!==_tag$configuration&&null!==(_tag$configuration$ap=_tag$configuration.appParam)&&void 0!==_tag$configuration$ap&&_tag$configuration$ap.value&&setText(widgetNotification.appParamsValue[tag.configuration.appParam.value]||tag.configuration.inputText)}))}),[notification]),(0,jsx_runtime.jsx)("div",{children:text})})),reactstrap_modern=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),DatePicker=(0,react.lazy)((function(){return __webpack_require__.e(576).then(__webpack_require__.bind(__webpack_require__,"./src/components/Common/DatePicker/index.js"))})),SelectOptionFilter=(0,react.lazy)((function(){return __webpack_require__.e(579).then(__webpack_require__.bind(__webpack_require__,"./src/components/Filter/SelectOptionFilter.jsx"))})),Filters=(0,react.memo)((function(_ref){var socket,filters=_ref.filters,widgets=_ref.widgets,_ref5=(0,react.useRef)([]),_useState=(0,react.useState)(filters||[]),_useState2=(0,slicedToArray.Z)(_useState,2),tags=_useState2[0],setTags=_useState2[1],_useState3=(0,react.useState)(!1),_useState4=(0,slicedToArray.Z)(_useState3,2),setShowDeleteDialog=(_useState4[0],_useState4[1]),_useState5=(0,react.useState)({}),_useState6=(0,slicedToArray.Z)(_useState5,2),setSelecteFilter=(_useState6[0],_useState6[1]),_useState7=(0,react.useState)({appParamsValue:{}}),_useState8=(0,slicedToArray.Z)(_useState7,2),notification=_useState8[0],sendNotification=(_useState8[1],function sendNotification(notification){socket||(socket=createSocket());var notif=(0,objectSpread2.Z)((0,objectSpread2.Z)({},notification),{},{appParamsValue:(0,objectSpread2.Z)({},notification.appParamsValue)});socket.emit("SEND_NOTIFICATION",{widgetSocketId:socket.id,widgetNotification:notif}),setTimeout((function(){NotificationService.O.sendNotification(notification)}),100)});(0,react.useEffect)((function(){_ref5.current=_ref5.current.slice(0,tags.length),socket||(socket=createSocket())}),[tags]),(0,react.useEffect)((function(){var newFilters=(0,toConsumableArray.Z)(filters),widgetInputParams=Object.keys(widgets).map((function(key){var _widgets$key$widget;return null===(_widgets$key$widget=widgets[key].widget)||void 0===_widgets$key$widget?void 0:_widgets$key$widget.datasource})).reduce((function(acc,datasource){var _datasource$query,_datasource$query$url,_datasource$query2;(null==datasource||null===(_datasource$query=datasource.query)||void 0===_datasource$query||null===(_datasource$query$url=_datasource$query.urlParams)||void 0===_datasource$query$url?void 0:_datasource$query$url.length)>0&&(acc=[].concat((0,toConsumableArray.Z)(acc),(0,toConsumableArray.Z)(null==datasource||null===(_datasource$query2=datasource.query)||void 0===_datasource$query2?void 0:_datasource$query2.urlParams)));return acc}),[]),filtersAppParams=filters.reduce((function(acc,_ref2){var appParam=_ref2.configuration.appParam;return acc=[].concat((0,toConsumableArray.Z)(acc),(0,toConsumableArray.Z)(Array.isArray(appParam)?appParam.map((function(_ref3){return _ref3.value})):[appParam.value]))}),[]);(widgetInputParams=(0,toConsumableArray.Z)(new Set(widgetInputParams))).forEach((function(paramName,index){NotificationService.B[paramName]&&filtersAppParams.indexOf(paramName)<0&&newFilters.push({_id:"".concat(paramName,"_").concat(index),name:paramName,type:"inputText",configuration:{appParam:{label:paramName,value:paramName},inputText:NotificationService.B[paramName]}})})),setTags(newFilters)}),[filters,Object.keys(NotificationService.B).length]);var createSocket=function createSocket(){return(socket=(0,esm.ZP)(resources.gs,{path:"/back/socket",transports:["websocket","polling"]})).on("connect",(function(){NotificationService.O.registerWidgetSocket(socket)})),socket.on("RECEIVE_NOTIFICATION",(function(notification){notification.widgetSocketId!=socket.id&&(NotificationService.O.isWidgetRegistredInSocketPool(notification.widgetSocketId)||NotificationService.O.sendNotification(notification.widgetNotification))})),socket},resetAppParams=function resetAppParams(filter){var _filter$configuration;Array.isArray(filter.configuration.appParam)?filter.configuration.appParam.forEach((function(_ref4){var value=_ref4.value;notification.appParamsValue[value]=""})):notification.appParamsValue[null===(_filter$configuration=filter.configuration.appParam)||void 0===_filter$configuration?void 0:_filter$configuration.value]="";sendNotification(notification)};return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)("div",{className:"dashboard-filters flex-wrap",children:tags&&tags.map((function(tag,index){var _tag$configuration$ap;return(0,jsx_runtime.jsxs)("div",{className:"filter-item",children:[(0,jsx_runtime.jsxs)("div",{className:"filter-item__title d-flex justify-content-between",children:[(0,jsx_runtime.jsx)("span",{children:tag.name||(null===(_tag$configuration$ap=tag.configuration.appParam)||void 0===_tag$configuration$ap?void 0:_tag$configuration$ap.label)}),"inputText"==tag.type?(0,jsx_runtime.jsx)(reactstrap_modern.zx,{close:!0,onClick:function onClick(){return function removeFilterTag(indexToRemove,filterToRemove){setShowDeleteDialog(!0),setSelecteFilter({item:filterToRemove,index:indexToRemove})}(index,tag)}}):null]}),(0,jsx_runtime.jsx)("span",{className:"filter-item__value",children:"datePickerAvance"===tag.type?(0,jsx_runtime.jsx)(DatePicker,{onSendNotification:sendNotification,tag:tag}):"inputText"===tag.type?(0,jsx_runtime.jsx)("span",{onClick:function onClick(){var _tag$configuration$ap2;return function dispatchFilterNotification(filterValue,param){notification.appParamsValue[param]=filterValue,sendNotification(notification)}(tag.configuration.inputText,null===(_tag$configuration$ap2=tag.configuration.appParam)||void 0===_tag$configuration$ap2?void 0:_tag$configuration$ap2.value)},children:(0,jsx_runtime.jsx)(Filter_InputTypeText,{tag:tag})}):"listeDeroulanteJson"===tag.type||"listeDeroulanteDataSource"===tag.type?(0,jsx_runtime.jsx)(SelectOptionFilter,{onSendNotification:sendNotification,onReset:function onReset(){return function resetFilter(filter,index){resetAppParams(filter),_ref5.current[index].resetSelection()}(tag,index)},tag:tag,ref:function ref(el){return _ref5.current[index]=el}}):""})]},index)}))})})})),Filter_Filters=Filters,context=__webpack_require__("./src/services/context.js"),Customizer=function(_React$PureComponent){(0,inherits.Z)(Customizer,_React$PureComponent);var _super=(0,createSuper.Z)(Customizer);function Customizer(props){var _this;return(0,classCallCheck.Z)(this,Customizer),(_this=_super.call(this,props)).setAppParams=function(){var filters=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(filters||[]).forEach((function(filter){var _filter$configuration,_filter$configuration2;if("datePickerAvance"==filter.type&&filter.configuration.appParam){var params=filter.configuration.appParam;NotificationService.B[params[0].value]=formatDate(filter.configuration.startDateRange),NotificationService.B[params[1].value]=formatDate(filter.configuration.endDateRange)}else"inputText"==filter.type&&null!==(_filter$configuration=filter.configuration)&&void 0!==_filter$configuration&&null!==(_filter$configuration2=_filter$configuration.appParam)&&void 0!==_filter$configuration2&&_filter$configuration2.value&&(NotificationService.B[filter.configuration.appParam.value]=filter.configuration.inputText)}))},_this.am4themes_dashboard=function(target){var _appearance$seriesCol,appearance=_this.props.appearance;if(target instanceof core.ColorSet&&(null==appearance||null===(_appearance$seriesCol=appearance.seriesColors)||void 0===_appearance$seriesCol?void 0:_appearance$seriesCol.length)>0&&(target.list=appearance.seriesColors.map((function(serieColor){return core.color(serieColor)}))),target instanceof core.InterfaceColorSet&&null!=appearance&&appearance.widgetBackground){var fgColor=core.color(null==appearance?void 0:appearance.widgetBackground).alternative;target.setFor("background",core.color(null==appearance?void 0:appearance.widgetBackground)),target.setFor("text",fgColor),target.setFor("grid",fgColor)}},_this.onWindowResize=function(){if(_this.mounted){var width=.95*window.innerWidth;_this.setState({width:width})}},_this.onLayoutChange=function(_,layouts){_this.setState({layouts:layouts})},_this.Widgets=function(){var widgets=_this.state.widgets,height={height:"100%"};return Object.keys(widgets).map((function(key){var _widgets$key$widget,_widgets$key$widget$s;return(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("div",{style:height,children:(0,jsx_runtime.jsx)(WidgetWrapper.default,(0,objectSpread2.Z)((0,objectSpread2.Z)({},widgets[key]),{},{showTitle:-1==["Image","Text"].indexOf(null===(_widgets$key$widget=widgets[key].widget)||void 0===_widgets$key$widget||null===(_widgets$key$widget$s=_widgets$key$widget.stWidget)||void 0===_widgets$key$widget$s?void 0:_widgets$key$widget$s.type)}))})},key)}))},_this.state={layouts:{},widgets:[],width:1200,widgetList:{},currentWidget:{},showWidgetEditor:!1},_this}return(0,createClass.Z)(Customizer,[{key:"componentDidMount",value:function componentDidMount(){this.setAppParams(this.props.filters),this.setState({widgets:this.props.widgets,layouts:this.props.layouts}),this.mounted=!0,window.addEventListener("resize",this.onWindowResize),this.onWindowResize(),core.useTheme(this.am4themes_dashboard)}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){this.props.widgets==prevProps.widgets&&this.props.layouts==prevProps.layouts||this.setState({widgets:this.props.widgets,layouts:this.props.layouts}),this.props.appearance!=prevProps.appearance&&core.useTheme(this.am4themes_dashboard)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.mounted=!1,window.removeEventListener("resize",this.onWindowResize)}},{key:"render",value:function render(){var _this$props=this.props,cols=_this$props.cols,breakpoints=_this$props.breakpoints,rowHeight=_this$props.rowHeight,width=_this$props.size.width,layouts=this.state.layouts;return(0,jsx_runtime.jsxs)(context.J,{children:[(0,jsx_runtime.jsx)(react.Suspense,{fallback:(0,jsx_runtime.jsx)("div",{}),children:(0,jsx_runtime.jsx)(Filter_Filters,{widgets:this.props.widgets,filters:this.props.filters})}),(0,jsx_runtime.jsx)("div",{className:"row m-auto",children:(0,jsx_runtime.jsx)(react_grid_layout.Responsive,{width:width,layouts:layouts,cols:cols,breakpoints:breakpoints,onLayoutChange:this.onLayoutChange,isDraggable:!1,isResizable:!1,rowHeight:rowHeight,resizeHandles:[],children:this.Widgets()})})]})}}]),Customizer}(react.PureComponent);Customizer.defaultProps={className:"layout",rowHeight:200,cols:{lg:12,md:10,sm:6,xs:4,xxs:2},breakpoints:{lg:1e3,md:996,sm:768,xs:480,xxs:0}},Customizer.__docgenInfo={description:"",methods:[{name:"setAppParams",docblock:null,modifiers:[],params:[{name:"filters",type:null}],returns:null},{name:"am4themes_dashboard",docblock:null,modifiers:[],params:[{name:"target",type:null}],returns:null},{name:"onWindowResize",docblock:null,modifiers:[],params:[],returns:null},{name:"onLayoutChange",docblock:null,modifiers:[],params:[{name:"_",type:null},{name:"layouts",type:null}],returns:null},{name:"Widgets",docblock:null,modifiers:[],params:[],returns:null}],displayName:"Customizer",props:{className:{defaultValue:{value:"'layout'",computed:!1},type:{name:"string"},required:!1,description:""},rowHeight:{defaultValue:{value:"200",computed:!1},type:{name:"number"},required:!1,description:""},cols:{defaultValue:{value:"{ lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 }",computed:!1},type:{name:"shape",value:{lg:{name:"number",required:!1},md:{name:"number",required:!1},sm:{name:"number",required:!1},xs:{name:"number",required:!1}}},required:!1,description:""},breakpoints:{defaultValue:{value:"{ lg: 1000, md: 996, sm: 768, xs: 480, xxs: 0 }",computed:!1},type:{name:"shape",value:{lg:{name:"number",required:!1},md:{name:"number",required:!1},sm:{name:"number",required:!1},xs:{name:"number",required:!1}}},required:!1,description:""},lg:{type:{name:"number"},required:!1,description:""},md:{type:{name:"number"},required:!1,description:""},size:{type:{name:"shape",value:{width:{name:"any",required:!1}}},required:!1,description:""},sm:{type:{name:"number"},required:!1,description:""},xs:{type:{name:"number"},required:!1,description:""},location:{type:{name:"shape",value:{pathname:{name:"string",required:!1}}},required:!1,description:""}}};var Dashboard_Customizer=(0,react_sizeme.withSize)()(Customizer);"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/Customizer.jsx"]={name:"Customizer",docgenInfo:Customizer.__docgenInfo,path:"src/components/Dashboard/Customizer.jsx"});var Dashboard=function Dashboard(props){var _useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),widgets=_useState2[0],setWidgets=_useState2[1],_useState3=(0,react.useState)({}),_useState4=(0,slicedToArray.Z)(_useState3,2),layouts=_useState4[0],setLayouts=_useState4[1],_useState5=(0,react.useState)([]),_useState6=(0,slicedToArray.Z)(_useState5,2),filters=_useState6[0],setFilters=_useState6[1],dashboardId=props.id,fetchFilters=function fetchFilters(){(function getDashboardFilter(dashboardId){var options={method:resources.lD.filter.getAll.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.filter.getAll.resource,"/").concat(dashboardId)};return(0,axios.Z)(options).then((function(res){return res.data})).catch((function(err){return err}))})(dashboardId).then((function(dashboardFilters){var filters=(dashboardFilters||[]).map((function(filter){var _filter$configuration;if("datePickerAvance"==filter.type&&"CUSTOM_RANGE"!=(null===(_filter$configuration=filter.configuration)||void 0===_filter$configuration?void 0:_filter$configuration.dateRangeType)){var _deductDateRangeFromT=function deductDateRangeFromType(type){var startDate=dayjs_min().toDate(),endDate=dayjs_min().toDate();switch(type){case"LAST_7_DAYS":startDate=dayjs_min().subtract(6,"days").toDate();break;case"LAST_30_DAYS":startDate=dayjs_min().subtract(29,"days").toDate();break;case"THIS_MONTH":startDate=dayjs_min().startOf("month").toDate(),endDate=dayjs_min().endOf("month").toDate();break;case"LAST_MONTH":startDate=dayjs_min().subtract(1,"month").startOf("month").toDate(),endDate=dayjs_min().subtract(1,"month").endOf("month").toDate()}return{startDate:startDate,endDate:endDate}}(filter.configuration.dateRangeType),startDate=_deductDateRangeFromT.startDate,endDate=_deductDateRangeFromT.endDate;filter.configuration.startDateRange=startDate,filter.configuration.endDateRange=endDate}return filter}));setFilters(filters)}))};return(0,react.useEffect)((function(){window.dbr_env=props.env,props.id&&(!function fetchWidgets(){(0,dashboard.h)(dashboardId).then((function(dashboardWidgets){var _dashboardWidgets$lay=dashboardWidgets.layouts,layouts=void 0===_dashboardWidgets$lay?{}:_dashboardWidgets$lay,_dashboardWidgets$wid=dashboardWidgets.widgets,widgets=void 0===_dashboardWidgets$wid?[]:_dashboardWidgets$wid,widgetsObject=(dashboardWidgets.appearance,{});widgets.forEach((function(widget){var _widget$stWidget;widget&&widget._id&&"publish"===widget.status&&(null!=widget&&null!==(_widget$stWidget=widget.stWidget)&&void 0!==_widget$stWidget&&_widget$stWidget.config&&"object"!=typeof widget.stWidget.config&&(widget.config=JSON.parse((null==widget?void 0:widget.stWidget.config)||widget.config)),widgetsObject[widget._id]={widget:widget})})),setWidgets(widgetsObject),setLayouts(layouts)}))}(),fetchFilters())}),[props.id,props.env]),(0,jsx_runtime.jsx)("div",{className:"container-fluid no-breadcrumbs page-dashboard",children:(0,jsx_runtime.jsx)(Dashboard_Customizer,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{dashboardID:dashboardId,widgets:widgets,layouts:layouts,filters:filters}))})};Dashboard.__docgenInfo={description:"",methods:[],displayName:"Dashboard",props:{id:{type:{name:"string"},required:!0,description:""},env:{type:{name:"enum",value:[{value:"'local'",computed:!1},{value:"'demo'",computed:!1},{value:"'sandbox'",computed:!1}]},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/Dashboard.jsx"]={name:"Dashboard",docgenInfo:Dashboard.__docgenInfo,path:"src/components/Dashboard/Dashboard.jsx"});var Dashboard_stories={parameters:{storySource:{source:"import React from 'react';\nimport { Dashboard as DashboardContainer } from '../components/Dashboard/Dashboard';\n\n// More on default export: https://storybook.js.org/docs/react/writing-stories/introduction#default-export\nexport default {\n  title: 'Components/Dashboard',\n  component: DashboardContainer,\n  // More on argTypes: https://storybook.js.org/docs/react/api/argtypes\n  argTypes: {\n    id: {\n      description: 'dashboard id',\n      type: { name: 'string', required: true },\n      control: {\n        type: 'text'\n      }\n    },\n    env: {\n      description: 'dbr environment',\n      options: ['local', 'demo', 'sandbox'],\n      type: { name: 'string', required: false },\n      control: {\n        type: 'select'\n      }\n    }\n  },\n};\n\nconst Template = (args) => <DashboardContainer {...args} />;\n\nexport const Dashboard = Template.bind({});\nDashboard.args = {\n  id: '',\n};\n",locationsMap:{dashboard:{startLoc:{col:17,line:28},endLoc:{col:59,line:28},startBody:{col:17,line:28},endBody:{col:59,line:28}}}}},title:"Components/Dashboard",component:Dashboard,argTypes:{id:{description:"dashboard id",type:{name:"string",required:!0},control:{type:"text"}},env:{description:"dbr environment",options:["local","demo","sandbox"],type:{name:"string",required:!1},control:{type:"select"}}}},Dashboard_stories_Dashboard=function Template(args){return(0,jsx_runtime.jsx)(Dashboard,(0,objectSpread2.Z)({},args))}.bind({});Dashboard_stories_Dashboard.args={id:""},Dashboard_stories_Dashboard.parameters=(0,objectSpread2.Z)({storySource:{source:"(args) => <DashboardContainer {...args} />"}},Dashboard_stories_Dashboard.parameters)},"./src/stories/DashboardItem.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Item:function(){return Item}});var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_components_Dashboard_DashboardList_DashboardItem__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/components/Dashboard/DashboardList/DashboardItem.jsx")),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");__webpack_exports__.default={parameters:{storySource:{source:"import React from 'react';\nimport DashboardItem from '../components/Dashboard/DashboardList/DashboardItem';\n\nexport default {\n  title: 'Components/Dashboard',\n  component: DashboardItem,\n  argTypes: {\n    name: {\n      description: 'dashboard name',\n      type: { name: 'string' },\n      control: {\n        type: 'text'\n      }\n    },\n    description: {\n      description: 'dashboard description',\n      type: { name: 'string' },\n      control: {\n        type: 'text'\n      }\n    },\n    updatedAt: {\n      description: 'last update',\n      type: { name: 'string' },\n      control: {\n        type: 'text'\n      }\n    },\n    onClick: {\n      description: 'func',\n      type: { name: 'func', required: false },\n      control: {\n        type: 'func'\n      }\n    }\n  },\n};\n\nconst Template = (args) => <DashboardItem {...args} />;\n\nexport const Item = Template.bind({});\nItem.args = {\n  name: 'lorem ipsum',\n  description: 'consectetur adipiscing',\n  updatedAt: '2021-12-23T10:51:29.452Z',\n};\n",locationsMap:{item:{startLoc:{col:17,line:39},endLoc:{col:54,line:39},startBody:{col:17,line:39},endBody:{col:54,line:39}}}}},title:"Components/Dashboard",component:_components_Dashboard_DashboardList_DashboardItem__WEBPACK_IMPORTED_MODULE_1__.Z,argTypes:{name:{description:"dashboard name",type:{name:"string"},control:{type:"text"}},description:{description:"dashboard description",type:{name:"string"},control:{type:"text"}},updatedAt:{description:"last update",type:{name:"string"},control:{type:"text"}},onClick:{description:"func",type:{name:"func",required:!1},control:{type:"func"}}}};var Item=function Template(args){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_components_Dashboard_DashboardList_DashboardItem__WEBPACK_IMPORTED_MODULE_1__.Z,(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},args))}.bind({});Item.args={name:"lorem ipsum",description:"consectetur adipiscing",updatedAt:"2021-12-23T10:51:29.452Z"},Item.parameters=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({storySource:{source:"(args) => <DashboardItem {...args} />"}},Item.parameters)},"./src/stories/DashboardList.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{List:function(){return List},default:function(){return DashboardList_stories}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),reactstrap_modern=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),dashboard=__webpack_require__("./src/api/dashboard/index.js"),DashboardItem=__webpack_require__("./src/components/Dashboard/DashboardList/DashboardItem.jsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),DashboardList=function DashboardList(_ref){var token=_ref.token,env=_ref.env,onClick=_ref.onClick,_useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),dashboards=_useState2[0],setDashboards=_useState2[1];return(0,react.useEffect)((function(){window.accessToken=token,window.dbr_env=env,token&&(0,dashboard.Y)().then((function(data){return setDashboards(data)}))}),[token,env]),(0,jsx_runtime.jsx)(reactstrap_modern.X2,{children:(null==dashboards?void 0:dashboards.length)>0&&dashboards.map((function(dashboard){return(0,jsx_runtime.jsx)(DashboardItem.Z,{onClick:onClick||!1,name:null==dashboard?void 0:dashboard.name,description:null==dashboard?void 0:dashboard.description,updatedAt:null==dashboard?void 0:dashboard.updatedAt},dashboard._id)}))})};DashboardList.__docgenInfo={description:"",methods:[],displayName:"DashboardList",props:{token:{type:{name:"string"},required:!0,description:""},env:{type:{name:"enum",value:[{value:"'local'",computed:!1},{value:"'demo'",computed:!1},{value:"'sandbox'",computed:!1}]},required:!1,description:""},onClick:{type:{name:"func"},required:!1,description:""}}};var DashboardList_DashboardList=DashboardList;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/DashboardList/DashboardList.jsx"]={name:"DashboardList",docgenInfo:DashboardList.__docgenInfo,path:"src/components/Dashboard/DashboardList/DashboardList.jsx"});var DashboardList_stories={parameters:{storySource:{source:"import React from 'react';\nimport DashboardList from '../components/Dashboard/DashboardList/DashboardList';\n\nexport default {\n  title: 'Components/Dashboard',\n  component: DashboardList,\n  argTypes: {\n    token: {\n      description: 'keycloack user valid token',\n      type: { name: 'string', required: true },\n      control: {\n        type: 'text'\n      }\n    },\n    env: {\n      description: 'dbr environment',\n      options: ['local', 'demo', 'sandbox'],\n      type: { name: 'string', required: false },\n      control: {\n        type: 'select'\n      }\n    },\n    onClick: {\n      description: 'func',\n      type: { name: 'func', required: false },\n      control: {\n        type: 'func'\n      }\n    }\n  },\n};\n\nconst Template = (args) => <DashboardList {...args} />;\n\nexport const List = Template.bind({});\nList.args = {\n  token: '',\n  env: 'local'\n};\n",locationsMap:{list:{startLoc:{col:17,line:33},endLoc:{col:54,line:33},startBody:{col:17,line:33},endBody:{col:54,line:33}}}}},title:"Components/Dashboard",component:DashboardList_DashboardList,argTypes:{token:{description:"keycloack user valid token",type:{name:"string",required:!0},control:{type:"text"}},env:{description:"dbr environment",options:["local","demo","sandbox"],type:{name:"string",required:!1},control:{type:"select"}},onClick:{description:"func",type:{name:"func",required:!1},control:{type:"func"}}}},List=function Template(args){return(0,jsx_runtime.jsx)(DashboardList_DashboardList,(0,objectSpread2.Z)({},args))}.bind({});List.args={token:"",env:"local"},List.parameters=(0,objectSpread2.Z)({storySource:{source:"(args) => <DashboardList {...args} />"}},List.parameters)},"./src/stories/Widget.stories.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Widget:function(){return Widget}});var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_components_Widget_WidgetWrapper__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./src/components/Widget/WidgetWrapper.jsx")),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");__webpack_exports__.default={parameters:{storySource:{source:"import React from 'react';\nimport WidgetWrapper from '../components/Widget/WidgetWrapper';\n\n\n// More on default export: https://storybook.js.org/docs/react/writing-stories/introduction#default-export\nexport default {\n  title: 'Components/Widget',\n  component: WidgetWrapper,\n  // More on argTypes: https://storybook.js.org/docs/react/api/argtypes\n  argTypes: {\n    widget: {\n      description: 'widget config',\n      type: { name: 'string', required: true },\n      control: {\n        type: 'object'\n      }\n    },\n    showTitle: {\n      description: 'show or hide widget header',\n      control: { type: 'boolean' },\n    },\n\n  },\n};\n\nconst Template = (args) => <div style={{ height: '400px' }}><WidgetWrapper {...args} /></div>;\n\nexport const Widget = Template.bind({});\nWidget.args = {\n  widget: {},\n  showTitle: true\n};\n",locationsMap:{widget:{startLoc:{col:17,line:26},endLoc:{col:93,line:26},startBody:{col:17,line:26},endBody:{col:93,line:26}}}}},title:"Components/Widget",component:_components_Widget_WidgetWrapper__WEBPACK_IMPORTED_MODULE_1__.default,argTypes:{widget:{description:"widget config",type:{name:"string",required:!0},control:{type:"object"}},showTitle:{description:"show or hide widget header",control:{type:"boolean"}}}};var Widget=function Template(args){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{style:{height:"400px"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_components_Widget_WidgetWrapper__WEBPACK_IMPORTED_MODULE_1__.default,(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},args))})}.bind({});Widget.args={widget:{},showTitle:!0},Widget.parameters=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({storySource:{source:"(args) => <div style={{ height: '400px' }}><WidgetWrapper {...args} /></div>"}},Widget.parameters)},"./.storybook/preview.js-generated-config-entry.js":function(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,{parameters:function(){return parameters}});var ClientApi=__webpack_require__("./node_modules/@storybook/client-api/dist/esm/ClientApi.js"),esm=__webpack_require__("./node_modules/@storybook/client-logger/dist/esm/index.js"),parameters={actions:{argTypesRegex:"^on[A-Z].*"},controls:{matchers:{color:/(background|color)$/i,date:/Date$/}}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.kg.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return(0,ClientApi.$9)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return(0,ClientApi.HZ)(loader,!1)}));case"parameters":return(0,ClientApi.h1)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return(0,ClientApi.My)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return(0,ClientApi._C)(enhancer)}));case"render":return(0,ClientApi.$P)(value);case"globals":case"globalTypes":var v={};return v[key]=value,(0,ClientApi.h1)(v,!1);case"decorateStory":case"renderToDOM":return null;default:return console.log(key+" was not supported :( !")}}))},"./src/api/axios.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/axios/index.js"),axios__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__),axiosApiInstance=axios__WEBPACK_IMPORTED_MODULE_1___default().create();axiosApiInstance.interceptors.request.use(function(){var _ref=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(config){return _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return config.headers={Authorization:"Bearer ".concat(window.accessToken),Accept:"application/json"},_context.abrupt("return",config);case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),(function(error){Promise.reject(error)})),axiosApiInstance.interceptors.response.use((function(response){return response}),function(){var _ref2=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee2(error){var originalRequest;return _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(originalRequest=error.config,403!==error.response.status||originalRequest._retry){_context2.next=5;break}return originalRequest._retry=!0,axios__WEBPACK_IMPORTED_MODULE_1___default().defaults.headers.common.Authorization="Bearer "+window.accessToken,_context2.abrupt("return",axiosApiInstance(originalRequest));case 5:return _context2.abrupt("return",Promise.reject(error));case 6:case"end":return _context2.stop()}}),_callee2)})));return function(_x2){return _ref2.apply(this,arguments)}}()),__webpack_exports__.Z=axiosApiInstance},"./src/api/dashboard/index.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{h:function(){return getDashboardWidgets},Y:function(){return getDashboards}});var axios=__webpack_require__("./src/api/axios.js"),resources=__webpack_require__("./src/constants/resources.js");function getDashboards(){var options={method:resources.lD.dashboard.get.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.dashboard.get.resource)};return(0,axios.Z)(options).then((function(res){return res.data})).catch((function(err){return err}))}var getDashboardWidgets=function getDashboardWidgets(id){var options={method:resources.lD.dashboard.getDashboardsWitgets.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.dashboard.getDashboardsWitgets.resource)+"/"+id};return(0,axios.Z)(options).then((function(res){return{name:res.data.name,description:res.data.description,widgets:res.data.widgets,layouts:res.data.layouts,appearance:res.data.appearance,share:res.data.share,role:res.data.role,owner:res.data.owner}})).catch((function(err){return err}))}},"./src/components/Dashboard/DashboardList/DashboardItem.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return DashboardList_DashboardItem}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),reactstrap_modern=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),ImageListView=function ImageListView(_ref){var _Date,name=_ref.name,description=_ref.description,updatedAt=_ref.updatedAt,onClick=_ref.onClick;return(0,jsx_runtime.jsx)(reactstrap_modern.JX,{sm:"6",lg:"4",xl:"3",className:"mb-3",children:(0,jsx_runtime.jsxs)(reactstrap_modern.Zb,{children:[(0,jsx_runtime.jsxs)("div",{className:"position-relative",children:[(0,jsx_runtime.jsx)(reactstrap_modern.Mo,{top:!0,alt:name,src:"assets/images/dashboard.png",loading:"lazy"}),(0,jsx_runtime.jsx)(reactstrap_modern.Ct,{type:"button",pill:!0,color:"info",className:"position-absolute badge-top-left d-flex badge-info",onClick:onClick,children:(0,jsx_runtime.jsx)("i",{className:"simple-icon-share-alt text-one px-1"})})]}),(0,jsx_runtime.jsx)(reactstrap_modern.eW,{className:"py-3",children:(0,jsx_runtime.jsx)(reactstrap_modern.X2,{children:(0,jsx_runtime.jsxs)(reactstrap_modern.JX,{xxs:"10",className:"mb-3",children:[(0,jsx_runtime.jsx)(reactstrap_modern._R,{className:"text-mlarge mb-1 text-capitalize",children:name}),(0,jsx_runtime.jsxs)(reactstrap_modern.SK,{className:"text-muted text-one mb-0 font-weight-light",children:[description&&description.length>0?null==description?void 0:description.toLowerCase():"",(0,jsx_runtime.jsx)("br",{}),(null===(_Date=new Date(updatedAt))||void 0===_Date?void 0:_Date.toDateString())||""]})]})})})]})})};ImageListView.__docgenInfo={description:"",methods:[],displayName:"ImageListView",props:{name:{type:{name:"any"},required:!1,description:""},description:{type:{name:"string"},required:!1,description:""},updatedAt:{type:{name:"any"},required:!1,description:""}}};var DashboardList_ImageListView=react.memo(ImageListView);"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/DashboardList/ImageListView.jsx"]={name:"ImageListView",docgenInfo:ImageListView.__docgenInfo,path:"src/components/Dashboard/DashboardList/ImageListView.jsx"});var DashboardItem=function DashboardItem(props){return(0,jsx_runtime.jsx)(DashboardList_ImageListView,(0,objectSpread2.Z)({},props))};DashboardItem.__docgenInfo={description:"",methods:[],displayName:"DashboardItem",props:{name:{type:{name:"any"},required:!1,description:""},description:{type:{name:"string"},required:!1,description:""},updatedAt:{type:{name:"string"},required:!1,description:""},onClick:{type:{name:"func"},required:!1,description:""}}};var DashboardList_DashboardItem=DashboardItem;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Dashboard/DashboardList/DashboardItem.jsx"]={name:"DashboardItem",docgenInfo:DashboardItem.__docgenInfo,path:"src/components/Dashboard/DashboardList/DashboardItem.jsx"})},"./src/components/Widget/Actions/WidgetActionsMenu.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),reactstrap__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),WidgetActionsMenu=(0,react__WEBPACK_IMPORTED_MODULE_0__.memo)((function(_ref){var onExport=_ref.onExport;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(reactstrap__WEBPACK_IMPORTED_MODULE_2__.OB,{className:"btn-group",direction:"left",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_2__.Z_,{tag:"span",size:"xs",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("i",{className:"simple-icon-options-vertical"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_2__.h_,{children:onExport&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(reactstrap__WEBPACK_IMPORTED_MODULE_2__.hP,{tag:"span",children:["Export",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"d-flex justify-content-center mt-1",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_2__.hE,{children:["png","svg","pdf","csv"].map((function(type){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(reactstrap__WEBPACK_IMPORTED_MODULE_2__.zx,{color:"dark",outline:!0,className:"border-radius p-1",onClick:function onClick(){return onExport(type)},children:type.toLocaleUpperCase()},type)}))})})]})})]})})}));__webpack_exports__.default=WidgetActionsMenu},"./src/components/Widget/NoDataFound.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),NoDataFound=(0,react__WEBPACK_IMPORTED_MODULE_0__.memo)((function(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"widgetWrapper",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)("div",{className:"actionsContainer",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("img",{src:"assets/images/nodata.svg",alt:"",title:"",style:{width:"45px"}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("h3",{className:"mt-2",children:"No data found"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("p",{className:"px-4",children:"No data to display for the selected metrics"})]})})}));__webpack_exports__.default=NoDataFound},"./src/components/Widget/WidgetWrapper.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return Widget_WidgetWrapper}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),react=__webpack_require__("./node_modules/react/index.js"),reactstrap_modern=__webpack_require__("./node_modules/reactstrap/dist/reactstrap.modern.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),inherits=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),createSuper=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createSuper.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),WidgetErrorBoundary=function(_Component){(0,inherits.Z)(WidgetErrorBoundary,_Component);var _super=(0,createSuper.Z)(WidgetErrorBoundary);function WidgetErrorBoundary(props){var _this;return(0,classCallCheck.Z)(this,WidgetErrorBoundary),(_this=_super.call(this,props)).state={hasError:!1,error:""},_this}return(0,createClass.Z)(WidgetErrorBoundary,[{key:"componentDidCatch",value:function componentDidCatch(error){this.setState({error:error})}},{key:"render",value:function render(){var hasError=this.state.hasError,children=this.props.children;return hasError?(0,jsx_runtime.jsxs)("div",{className:"text-center",style:{margin:"20px auto",overflow:"auto"},children:[(0,jsx_runtime.jsx)("img",{src:"assets/images/iconwrong.svg",alt:"",title:"",style:{width:"10%"}}),(0,jsx_runtime.jsxs)("h3",{className:"text-muted m-2",children:["Désolé, une erreur innatendue s’est produite..."," "]})]}):children}}],[{key:"getDerivedStateFromError",value:function getDerivedStateFromError(){return{hasError:!0}}}]),WidgetErrorBoundary}(react.Component);WidgetErrorBoundary.__docgenInfo={description:"",methods:[],displayName:"WidgetErrorBoundary"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/errorBoundaries/WidgetErrorBoundary.jsx"]={name:"WidgetErrorBoundary",docgenInfo:WidgetErrorBoundary.__docgenInfo,path:"src/errorBoundaries/WidgetErrorBoundary.jsx"});__webpack_require__("./src/components/Widget/widgetWrapper.scss");var datasourceManager=__webpack_require__("./src/services/datasource/datasourceManager.js"),WidgetActionsMenu=__webpack_require__("./src/components/Widget/Actions/WidgetActionsMenu.jsx"),constants_widget=__webpack_require__("./src/constants/widget.js"),NoDataFound=__webpack_require__("./src/components/Widget/NoDataFound.jsx"),NotificationService=__webpack_require__("./src/services/NotificationService.js"),WidgetWrapper=function WidgetWrapper(props){var _props$appearance,_props$appearance2,_useState=(0,react.useState)({}),_useState2=(0,slicedToArray.Z)(_useState,2),Widget=_useState2[0],setWidget=_useState2[1],_useState3=(0,react.useState)([]),_useState4=(0,slicedToArray.Z)(_useState3,2),widgetData=_useState4[0],setWidgetData=_useState4[1],_useState5=(0,react.useState)(),_useState6=(0,slicedToArray.Z)(_useState5,2),mode=_useState6[0],setMode=_useState6[1],exportChart=react.useRef(null),initChart=react.useRef(null);(0,react.useEffect)((function(){props.widget&&loadWidget()}),[]),(0,react.useEffect)((function(){null!=initChart&&initChart.current&&initChart.current()}),[null===(_props$appearance=props.appearance)||void 0===_props$appearance?void 0:_props$appearance.widgetBackground,null===(_props$appearance2=props.appearance)||void 0===_props$appearance2?void 0:_props$appearance2.seriesColors]),(0,react.useEffect)((function(){fetchWidgetData(NotificationService.B)}),[props.widget.mappingParams,props.widget.mappingResponseParams]);var fetchWidgetData=function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var paramsValue,datasource,result,_args=arguments;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(paramsValue=_args.length>0&&void 0!==_args[0]?_args[0]:[],props.widget.datasource&&(props.widget.datasource.query||"csv_file"==props.widget.datasource.type)){_context.next=3;break}return _context.abrupt("return");case 3:return(datasource=(0,objectSpread2.Z)({},props.widget.datasource)).query&&(datasource.query.paramsValue=paramsValue),_context.next=7,(0,datasourceManager.f)(datasource);case 7:(result=_context.sent)&&0!=result.length&&"error"!=result.status?(setWidgetData(result),setMode("DataFound")):(setWidgetData([]),setMode("NoDataFound"));case 9:case"end":return _context.stop()}}),_callee)})));return function fetchWidgetData(){return _ref.apply(this,arguments)}}(),loadWidget=function loadWidget(){var widget=props.widget;widget.stWidget&&setWidget((0,react.lazy)((function(){try{var systemWidget=(0,constants_widget.OT)(widget.stWidget.type);return __webpack_require__("./src/components/Widget lazy recursive ^\\.\\/.*$")("./".concat(systemWidget?widget.stWidget.type:"GenericWidget"))}catch(error){return error}})))},widget=props.widget,showTitle=props.showTitle;return widget?(console.log("===",JSON.stringify(widget)),(0,jsx_runtime.jsx)("div",{className:"widget h-100",children:Widget&&0!==Object.keys(Widget).length&&(0,jsx_runtime.jsxs)(reactstrap_modern.Zb,{style:{height:"100%"},className:"widget-card",children:[showTitle&&widget.name&&(0,jsx_runtime.jsxs)(reactstrap_modern.Ol,{className:"py-1 px-3 widget-header",children:[(0,jsx_runtime.jsxs)("div",{className:"d-flex flex flex-md-row align-items-center",children:[(0,jsx_runtime.jsx)("p",{className:"ml-2 mb-0 py-2 w-100 w-xs-100 text-sxlarge",children:widget.name}),(0,jsx_runtime.jsx)(WidgetActionsMenu.default,{widget:widget,onExport:(0,constants_widget.OT)(widget.stWidget.type)?null:exportChart.current})]}),(0,jsx_runtime.jsx)("div",{className:"separator"})]}),(0,jsx_runtime.jsx)(reactstrap_modern.eW,{className:"p-0 position-relative h-100 overflow-auto",children:(0,jsx_runtime.jsx)(WidgetErrorBoundary,{children:(0,jsx_runtime.jsxs)(react.Suspense,{fallback:(0,jsx_runtime.jsx)("div",{className:"loading"}),children:[(0,jsx_runtime.jsx)(Widget,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{widget:(0,objectSpread2.Z)((0,objectSpread2.Z)((0,objectSpread2.Z)({},widget.stWidget),widget),{},{data:widgetData}),onReceiveNotification:function handleWidgetNotification(){var paramsValue=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(props.widget.datasource){var _query$urlParams,query=props.widget.datasource.query;if(!(null!=query&&null!==(_query$urlParams=query.urlParams)&&void 0!==_query$urlParams&&_query$urlParams.length)>0)return}fetchWidgetData(paramsValue)},exportChart:exportChart,initChart:initChart})),"NoDataFound"===mode&&(0,jsx_runtime.jsx)(NoDataFound.default,{})]})})})]})})):null};WidgetWrapper.__docgenInfo={description:"",methods:[],displayName:"WidgetWrapper",props:{widget:{type:{name:"shape",value:{name:{name:"string",required:!1},env:{name:"enum",value:[{value:"'local'",computed:!1},{value:"'demo'",computed:!1},{value:"'sandbox'",computed:!1}],required:!1}}},required:!1,description:""},showTitle:{type:{name:"bool"},required:!1,description:""}}};var Widget_WidgetWrapper=WidgetWrapper;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Widget/WidgetWrapper.jsx"]={name:"WidgetWrapper",docgenInfo:WidgetWrapper.__docgenInfo,path:"src/components/Widget/WidgetWrapper.jsx"})},"./src/constants/resources.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{lD:function(){return BACKEND_API_RESOURCES},gs:function(){return BACKEND_SOCKET_API_URL},kG:function(){return getApiUrl}});var process=__webpack_require__("./node_modules/process/browser.js"),getApiUrl=function getApiUrl(){var url="http://localhost:3005";switch(window.dbr_env){case"local":url="http://localhost:3005";break;case"demo":url="http://10.16.128.43:3005";break;case"sandbox":url="https://dbr-sandbox.um6p.ma/back"}return url},BACKEND_SOCKET_API_URL=(getApiUrl(),process.env.REACT_APP_SOCKET_API_HOST),BACKEND_API_RESOURCES={filter:{getAll:{method:"GET",resource:"".concat("api","/filters"),secured:!1},get:{method:"GET",resource:"".concat("api","/filter"),secured:!1}},dashboard:{get:{method:"GET",resource:"".concat("api","/dashboards"),secured:!1},getDashboardsWitgets:{method:"GET",resource:"".concat("api","/dashboard"),secured:!1}},dashboards:{get:{method:"GET",resource:"".concat("api","/dashboards"),secured:!0}},nodes:{get:{method:"GET",resource:"".concat("api","/nodes"),secured:!0}},datasource:{fetchQuery:{method:"GET",resource:"".concat("api","/datasource/fetchQuery"),secured:!1}}}},"./src/constants/widget.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{OT:function(){return isSystemWidget},T_:function(){return getWidgetIcon}});var process=__webpack_require__("./node_modules/process/browser.js"),isSystemWidget=function isSystemWidget(widgetType){return["Tree","DataGrid","Map","Image","Text"].indexOf(widgetType)>-1},SYSTEM_WIDGETS={Tree:{_id:"Tree",name:"Tree",type:"Tree",status:"publish",icon:""},DataGrid:{_id:"DataGrid",name:"Data grid",type:"DataGrid",status:"publish",icon:"",params:[]},Map:{_id:"Map",name:"Map",type:"Map",status:"publish",icon:""}},getWidgetIcon=function getWidgetIcon(widget){var _widget$stWidget,_SYSTEM_WIDGETS$widge,_widget$stWidget2;if("Image"==widget.stWidget.type){var extension=widget.name.slice(widget.name.lastIndexOf("."));return"".concat(process.env.REACT_APP_S3_URL).concat(widget._id).concat(extension)}return(null===(_widget$stWidget=widget.stWidget)||void 0===_widget$stWidget?void 0:_widget$stWidget.icon)||(null===(_SYSTEM_WIDGETS$widge=SYSTEM_WIDGETS[null==widget||null===(_widget$stWidget2=widget.stWidget)||void 0===_widget$stWidget2?void 0:_widget$stWidget2.type])||void 0===_SYSTEM_WIDGETS$widge?void 0:_SYSTEM_WIDGETS$widge.icon)}},"./src/services/NotificationService.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{B:function(){return mapParams},O:function(){return notificationService}});var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),subject=new(__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js").x),widgetSockets=[],mapParams={},notificationService={sendNotification:function sendNotification(notification){for(var _i=0,_Object$keys=Object.keys(notification.appParamsValue);_i<_Object$keys.length;_i++){var key=_Object$keys[_i],value=notification.appParamsValue[key];value&&""!=value?mapParams[key]=value:delete mapParams[key]}notification.appParamsValue=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.Z)({},mapParams),subject.next(notification)},getNotification:function getNotification(){return subject.asObservable()},registerWidgetSocket:function registerWidgetSocket(socket){socket&&widgetSockets.push(socket.id)},isWidgetRegistredInSocketPool:function isWidgetRegistredInSocketPool(widgetSocketId){return widgetSockets.indexOf(widgetSocketId)>=0}}},"./src/services/context.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{h:function(){return DbrContext},J:function(){return DbrProvider}});var _Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),dbrContextValue={dashboard:{dashboardId:null,widgets:[]},map:{nodes:[],data:[],status:!0,marker:{id:""},currentNodeId:null},datePicker:{dateRange:{start:(new Date).setDate(0),end:new Date}}},DbrContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(dbrContextValue),DbrProvider=function DbrProvider(props){var initialMapData={nodes:[],mapNodes:[],data:[],currentNodeId:null},initState={dashboard:{dashboardId:null,widgets:[]},map:{},setMapData:function setMapData(treeId){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};setState((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)({},state),{},{map:(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)({},state.map),{},(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},treeId,(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)((0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_2__.Z)({},state.map[treeId]?state.map[treeId]:initialMapData),data)))}))}},_useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initState),_useState2=(0,_Users_lidrissi_Documents_um6p_dbr_ui_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_useState,2),state=_useState2[0],setState=_useState2[1];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(DbrContext.Provider,{value:state,children:props.children})};DbrProvider.__docgenInfo={description:"",methods:[],displayName:"DbrProvider"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/services/context.js"]={name:"DbrProvider",docgenInfo:DbrProvider.__docgenInfo,path:"src/services/context.js"})},"./src/services/datasource/datasourceManager.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{f:function(){return datasourceManager_fetchDatasourceQuery}});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),inherits=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/inherits.js"),createSuper=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createSuper.js"),axios=__webpack_require__("./src/api/axios.js"),resources=__webpack_require__("./src/constants/resources.js"),fetchDatasourceQuery=function fetchDatasourceQuery(datasource){delete datasource.queries,delete datasource.owner,delete datasource.share;var options={method:resources.lD.datasource.fetchQuery.method,url:"".concat((0,resources.kG)(),"/").concat(resources.lD.datasource.fetchQuery.resource),params:datasource};return(0,axios.Z)(options).then((function(res){return res.data})).catch((function(){return[]}))},process=__webpack_require__("./node_modules/process/browser.js"),Datasource=function(){function Datasource(config){(0,classCallCheck.Z)(this,Datasource),this.config=config}return(0,createClass.Z)(Datasource,[{key:"fetchData",value:function fetchData(){}}]),Datasource}(),getDatasourceFilePath=function getDatasourceFilePath(datasource){var fileName=datasource.host,extension=fileName.slice(fileName.lastIndexOf(".")),domain="s3"==datasource.storage?process.env.REACT_APP_S3_URL:process.env.REACT_APP_API_HOST+"/";return"".concat(domain).concat(datasource._id).concat(extension)},Database=function(_Datasource){(0,inherits.Z)(Database,_Datasource);var _fetchData,_super=(0,createSuper.Z)(Database);function Database(){var _this;(0,classCallCheck.Z)(this,Database);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).multiReplace=function(str,regex,replaces){return str.replace(regex,(function(x){var param=x.replace(":","");return Object.keys(replaces).includes(param)?'"'.concat(replaces[param],'"'):"''"}))},_this}return(0,createClass.Z)(Database,[{key:"fetchData",value:(_fetchData=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var _this$config$query,urlParams,paramsValue,query;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _this$config$query=this.config.query,urlParams=_this$config$query.urlParams,paramsValue=_this$config$query.paramsValue,query=(0,objectSpread2.Z)({},this.config.query),(null==urlParams?void 0:urlParams.length)>0&&(query.value=this.multiReplace(query.value,new RegExp(urlParams.map((function(i){return":".concat(i)})).join("|"),"g"),paramsValue||{})),_context.next=5,fetchDatasourceQuery((0,objectSpread2.Z)((0,objectSpread2.Z)({},this.config),{},{query:query}));case 5:return _context.abrupt("return",_context.sent);case 6:case"end":return _context.stop()}}),_callee,this)}))),function fetchData(){return _fetchData.apply(this,arguments)})}]),Database}(Datasource),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),es=__webpack_require__("./node_modules/hyperformula/es/index.js"),csvFile=function(_Datasource){(0,inherits.Z)(csvFile,_Datasource);var _fetchData,_super=(0,createSuper.Z)(csvFile);function csvFile(){var _this;(0,classCallCheck.Z)(this,csvFile);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).csvTojson=function(str){var delimiter=_this.config.fieldSeparator,titles=str.slice(0,str.indexOf("\n")).split(delimiter),rows=str.slice(str.indexOf("\n")+1).split("\n");if((null==titles?void 0:titles.length)<2||(null==rows?void 0:rows.length)<2)throw new Error("invalid file");return rows.map((function(row){var values=row.split(delimiter);return titles.reduce((function(object,curr,i){return object[curr]=values[i],object}),{})}))},_this.getFilePathResponse=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var path,request;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return path=getDatasourceFilePath(_this.config),request=new XMLHttpRequest,_context.next=4,request.open("GET",path,!1);case 4:return request.send(),_context.abrupt("return",request.response);case 6:case"end":return _context.stop()}}),_callee)}))),_this}return(0,createClass.Z)(csvFile,[{key:"fetchData",value:(_fetchData=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var csvData,fileResponse,_csvData,data,hfInstance,lastColumnIndex,_this2=this;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return csvData=[],_context2.prev=1,_context2.next=4,this.getFilePathResponse();case 4:fileResponse=_context2.sent,csvData=this.csvTojson(fileResponse),this.config.query&&(data=csvData.map((function(item){return[].concat((0,toConsumableArray.Z)(Object.values(item)),[_this2.config.query.value])})),hfInstance=es.GP.buildFromArray(data,{licenseKey:"gpl-v3"}),lastColumnIndex=(null===(_csvData=csvData)||void 0===_csvData?void 0:_csvData.length)>0?Object.keys(csvData[0]).length:0,csvData.forEach((function(item,index){item[_this2.config.query.name]=hfInstance.getCellValue({col:lastColumnIndex,row:index,sheet:0})}))),_context2.next=12;break;case 9:_context2.prev=9,_context2.t0=_context2.catch(1),console.error(_context2.t0);case 12:return _context2.abrupt("return",csvData);case 13:case"end":return _context2.stop()}}),_callee2,this,[[1,9]])}))),function fetchData(){return _fetchData.apply(this,arguments)})}]),csvFile}(Datasource),node_modules_axios=__webpack_require__("./node_modules/axios/index.js"),axios_default=__webpack_require__.n(node_modules_axios),WebService=function(_Datasource){(0,inherits.Z)(WebService,_Datasource);var _testConnection,_super=(0,createSuper.Z)(WebService);function WebService(){return(0,classCallCheck.Z)(this,WebService),_super.apply(this,arguments)}return(0,createClass.Z)(WebService,[{key:"testConnection",value:(_testConnection=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var xhr;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return(xhr=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP")).open("HEAD",this.config.host||"",!1),_context.prev=2,_context.next=5,xhr.send();case 5:return _context.abrupt("return",{status:xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"});case 8:return _context.prev=8,_context.t0=_context.catch(2),_context.abrupt("return",{status:"success"});case 11:case"end":return _context.stop()}}),_callee,this,[[2,8]])}))),function testConnection(){return _testConnection.apply(this,arguments)})},{key:"fetchData",value:function fetchData(){var _this$config$headers,url=this.config.host.replace(/\/$/,"")+"/"+this.config.query.value.replace(/^\//,"").replace(/\/$/,""),_this$config$query=this.config.query,urlParams=_this$config$query.urlParams,paramsValue=_this$config$query.paramsValue;if((null==urlParams?void 0:urlParams.length)>0&&paramsValue){var isFirstParam=!url.includes("?");url=urlParams.reduce((function(acc,param){return paramsValue.hasOwnProperty(param)&&(acc+="".concat(isFirstParam?"?":"&").concat(param,"=").concat(paramsValue[param]),isFirstParam=!1),acc}),url)}console.log("url ==>",url);var options={method:"GET",data:{},url:url};if((null===(_this$config$headers=this.config.headers)||void 0===_this$config$headers?void 0:_this$config$headers.length)>0)try{var headers=JSON.parse(this.config.headers);options.headers=headers}catch(error){console.error(error)}return axios_default()(options).then((function(res){return res.data})).catch((function(err){return{status:"error",message:err.toString()}}))}}]),WebService}(Datasource),DatasourceManager=function(){function DatasourceManager(config){(0,classCallCheck.Z)(this,DatasourceManager),["mysql","pgsql","mssql","mongo"].indexOf(config.type)>-1?this.datasource=new Database(config):"url"==config.type?this.datasource=new WebService(config):"csv_file"==config.type&&(this.datasource=new csvFile(config))}var _fetchData;return(0,createClass.Z)(DatasourceManager,[{key:"fetchData",value:(_fetchData=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.datasource.fetchData();case 2:return _context.abrupt("return",_context.sent);case 3:case"end":return _context.stop()}}),_callee,this)}))),function fetchData(){return _fetchData.apply(this,arguments)})}]),DatasourceManager}(),datasourceManager_fetchDatasourceQuery=function(){var _ref=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(config){var manager,result;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return manager=new DatasourceManager(config),_context2.next=3,manager.fetchData();case 3:return result=_context2.sent,_context2.abrupt("return",result);case 5:case"end":return _context2.stop()}}),_callee2)})));return function fetchDatasourceQuery(_x){return _ref.apply(this,arguments)}}()},"./src/components/Widget/widgetWrapper.scss":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default={}},"./src/components/Widget lazy recursive ^\\.\\/.*$":function(module,__unused_webpack_exports,__webpack_require__){var map={"./Actions/WidgetActionsMenu":["./src/components/Widget/Actions/WidgetActionsMenu.jsx",9],"./Actions/WidgetActionsMenu.jsx":["./src/components/Widget/Actions/WidgetActionsMenu.jsx",9],"./DataGrid":["./src/components/Widget/DataGrid/index.js",9,356,690,587],"./DataGrid/":["./src/components/Widget/DataGrid/index.js",9,356,690,587],"./DataGrid/DataGrid":["./src/components/Widget/DataGrid/DataGrid.jsx",9,356,690,600],"./DataGrid/DataGrid.jsx":["./src/components/Widget/DataGrid/DataGrid.jsx",9,356,690,600],"./DataGrid/index":["./src/components/Widget/DataGrid/index.js",9,356,690,587],"./DataGrid/index.js":["./src/components/Widget/DataGrid/index.js",9,356,690,587],"./GenericWidget":["./src/components/Widget/GenericWidget/index.js",9,806,868],"./GenericWidget/":["./src/components/Widget/GenericWidget/index.js",9,806,868],"./GenericWidget/GenericWidget":["./src/components/Widget/GenericWidget/GenericWidget.jsx",9,806,922],"./GenericWidget/GenericWidget.jsx":["./src/components/Widget/GenericWidget/GenericWidget.jsx",9,806,922],"./GenericWidget/index":["./src/components/Widget/GenericWidget/index.js",9,806,868],"./GenericWidget/index.js":["./src/components/Widget/GenericWidget/index.js",9,806,868],"./Image":["./src/components/Widget/Image/index.js",9,525],"./Image/":["./src/components/Widget/Image/index.js",9,525],"./Image/Image":["./src/components/Widget/Image/Image.jsx",9,10],"./Image/Image.jsx":["./src/components/Widget/Image/Image.jsx",9,10],"./Image/image.scss":["./src/components/Widget/Image/image.scss",9,566],"./Image/index":["./src/components/Widget/Image/index.js",9,525],"./Image/index.js":["./src/components/Widget/Image/index.js",9,525],"./Map":["./src/components/Widget/Map/index.js",9,54,623],"./Map/":["./src/components/Widget/Map/index.js",9,54,623],"./Map/Map":["./src/components/Widget/Map/Map.jsx",9,54,858],"./Map/Map.jsx":["./src/components/Widget/Map/Map.jsx",9,54,858],"./Map/components/PolygonWrapper":["./src/components/Widget/Map/components/PolygonWrapper.jsx",9,54,255],"./Map/components/PolygonWrapper.jsx":["./src/components/Widget/Map/components/PolygonWrapper.jsx",9,54,255],"./Map/index":["./src/components/Widget/Map/index.js",9,54,623],"./Map/index.js":["./src/components/Widget/Map/index.js",9,54,623],"./Map/map.worker":["./src/components/Widget/Map/map.worker.js",9,541],"./Map/map.worker.js":["./src/components/Widget/Map/map.worker.js",9,541],"./Map/mapStyles":["./src/components/Widget/Map/mapStyles.json",3,406],"./Map/mapStyles.json":["./src/components/Widget/Map/mapStyles.json",3,406],"./Map/workerSetup":["./src/components/Widget/Map/workerSetup.js",9,674],"./Map/workerSetup.js":["./src/components/Widget/Map/workerSetup.js",9,674],"./NoDataFound":["./src/components/Widget/NoDataFound.jsx",9],"./NoDataFound.jsx":["./src/components/Widget/NoDataFound.jsx",9],"./Text":["./src/components/Widget/Text/index.js",9,151],"./Text/":["./src/components/Widget/Text/index.js",9,151],"./Text/Text":["./src/components/Widget/Text/Text.jsx",9,567],"./Text/Text.jsx":["./src/components/Widget/Text/Text.jsx",9,567],"./Text/index":["./src/components/Widget/Text/index.js",9,151],"./Text/index.js":["./src/components/Widget/Text/index.js",9,151],"./Tree":["./src/components/Widget/Tree/index.js",9,356,853,337],"./Tree/":["./src/components/Widget/Tree/index.js",9,356,853,337],"./Tree/SearchBar":["./src/components/Widget/Tree/SearchBar.jsx",9,178],"./Tree/SearchBar.jsx":["./src/components/Widget/Tree/SearchBar.jsx",9,178],"./Tree/Tree":["./src/components/Widget/Tree/Tree.jsx",9,356,853,314],"./Tree/Tree.jsx":["./src/components/Widget/Tree/Tree.jsx",9,356,853,314],"./Tree/TreeContent":["./src/components/Widget/Tree/TreeContent.js",9,356,853,709],"./Tree/TreeContent.js":["./src/components/Widget/Tree/TreeContent.js",9,356,853,709],"./Tree/index":["./src/components/Widget/Tree/index.js",9,356,853,337],"./Tree/index.js":["./src/components/Widget/Tree/index.js",9,356,853,337],"./Tree/tree.scss":["./src/components/Widget/Tree/tree.scss",9,177],"./Tree/useNodeNotification":["./src/components/Widget/Tree/useNodeNotification.jsx",9,428],"./Tree/useNodeNotification.jsx":["./src/components/Widget/Tree/useNodeNotification.jsx",9,428],"./WidgetWrapper":["./src/components/Widget/WidgetWrapper.jsx",9],"./WidgetWrapper.jsx":["./src/components/Widget/WidgetWrapper.jsx",9],"./widgetWrapper.scss":["./src/components/Widget/widgetWrapper.scss",9]};function webpackAsyncContext(req){if(!__webpack_require__.o(map,req))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}));var ids=map[req],id=ids[0];return Promise.all(ids.slice(2).map(__webpack_require__.e)).then((function(){return __webpack_require__.t(id,16|ids[1])}))}webpackAsyncContext.keys=function(){return Object.keys(map)},webpackAsyncContext.id="./src/components/Widget lazy recursive ^\\.\\/.*$",module.exports=webpackAsyncContext},"./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js|jsx|ts|tsx))$":function(module,__unused_webpack_exports,__webpack_require__){var map={"./stories/Dashboard.stories.jsx":"./src/stories/Dashboard.stories.jsx","./stories/DashboardItem.stories.jsx":"./src/stories/DashboardItem.stories.jsx","./stories/DashboardList.stories.jsx":"./src/stories/DashboardList.stories.jsx","./stories/Widget.stories.jsx":"./src/stories/Widget.stories.jsx"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.(js|jsx|ts|tsx))$"},"./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$":function(module,__unused_webpack_exports,__webpack_require__){var map={"./stories/Installation.stories.mdx":"./src/stories/Installation.stories.mdx"};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id="./src sync recursive ^\\.(?:(?:^|\\/|(?:(?:(?%21(?:^|\\/)\\.).)*?)\\/)(?%21\\.)(?=.)[^/]*?\\.stories\\.mdx)$"},"./storybook-init-framework-entry.js":function(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__){"use strict";__webpack_require__("./node_modules/@storybook/react/dist/esm/client/index.js")},"?4f7e":function(){}},function(__webpack_require__){var __webpack_exec__=function(moduleId){return __webpack_require__(__webpack_require__.s=moduleId)};__webpack_require__.O(0,[488],(function(){return __webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/polyfills.js"),__webpack_exec__("./node_modules/@storybook/core-client/dist/esm/globals/globals.js"),__webpack_exec__("./storybook-init-framework-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-docs/dist/esm/frameworks/common/config.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-docs/dist/esm/frameworks/react/config.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/react/dist/esm/client/preview/config-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-links/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-actions/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-actions/dist/esm/preset/addArgs.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-backgrounds/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-backgrounds/dist/esm/preset/addParameter.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-measure/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./node_modules/@storybook/addon-outline/dist/esm/preset/addDecorator.js-generated-config-entry.js"),__webpack_exec__("./.storybook/preview.js-generated-config-entry.js"),__webpack_exec__("./generated-stories-entry.js")}));__webpack_require__.O()}]);